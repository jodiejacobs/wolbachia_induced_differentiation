2025-03-14 15:30:40,305 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 15:30:40,306 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 15:30:40,306 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-14 15:30:40,306 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 15:30:40,306 - INFO - Loading data files...
2025-03-14 15:30:40,465 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 15:34:19,688 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-14 15:34:19,714 - INFO - Number of shared genes: 10618
2025-03-14 15:34:19,715 - INFO - Preprocessing datasets...
2025-03-14 15:51:42,310 - INFO - Using 10618 shared genes
2025-03-14 15:58:05,003 - INFO - Integrating datasets...
2025-03-14 15:58:06,920 - INFO - Combined dataset shape: (12822, 10618)
2025-03-14 15:58:06,920 - INFO - Data is already normalized and log-transformed
2025-03-14 15:58:10,222 - INFO - Applying BBKNN batch correction...
2025-03-14 15:58:17,693 - INFO - Automatically determined k = 23 (sqrt(n) = 113, 10% of smallest class = 23)
2025-03-14 15:58:17,694 - INFO - Performing kNN classification with k=23...
2025-03-14 15:58:17,699 - INFO - Sample values from 'cell_type': ['maternal', 'maternal', 'maternal', 'maternal', 'maternal']
2025-03-14 15:58:17,748 - INFO - Successfully extracted 12798 reference labels
2025-03-14 15:58:17,749 - INFO - Reference cells: 12798, Bulk samples: 24
2025-03-14 15:58:17,749 - INFO - Using UMAP embeddings for kNN search
2025-03-14 15:58:17,749 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-14 15:58:18,186 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-14 15:58:18,600 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-14 15:58:19,012 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-14 15:58:19,401 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-14 15:58:19,787 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-14 15:58:20,169 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-14 15:58:20,555 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-14 15:58:20,943 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-14 15:58:21,336 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-14 15:58:21,735 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-14 15:58:22,129 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-14 15:58:22,528 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-14 15:58:22,908 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-14 15:58:23,309 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-14 15:58:23,694 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-14 15:58:24,070 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-14 15:58:24,459 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-14 15:58:24,840 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-14 15:58:25,217 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-14 15:58:25,588 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-14 15:58:25,976 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-14 15:58:26,358 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-14 15:58:26,752 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-14 15:58:27,123 - INFO - kNN classification completed for all 24 bulk samples
2025-03-14 15:58:27,124 - INFO - Classification summary:
2025-03-14 15:58:27,128 - INFO -   maternal: 24 bulk samples (mean confidence: 1.0000)
2025-03-14 15:58:27,128 - INFO - P-value summary:
2025-03-14 15:58:27,128 - INFO -   Mean p-value: 1.0000
2025-03-14 15:58:27,129 - INFO -   Median p-value: 1.0000
2025-03-14 15:58:27,130 - INFO -   Min p-value: 1.0000
2025-03-14 15:58:27,130 - INFO -   Max p-value: 1.0000
2025-03-14 15:58:27,130 - INFO - Generating UMAP visualizations...
2025-03-14 16:01:06,494 - INFO - UMAP visualizations completed
2025-03-14 16:01:08,038 - INFO - Integration pipeline completed successfully
2025-03-14 16:01:08,039 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 16:01:08,039 - INFO - Plotting UMAP...
2025-03-14 16:10:30,215 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 16:10:30,217 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 16:10:30,217 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/fca_adata.h5ad
2025-03-14 16:10:30,218 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 16:10:30,218 - INFO - Loading data files...
2025-03-14 16:10:30,365 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 16:13:36,363 - INFO - Reference dataset loaded: (62515, 2431) (cells × genes)
2025-03-14 16:13:36,373 - INFO - Number of shared genes: 1234
2025-03-14 16:13:36,373 - INFO - Preprocessing datasets...
2025-03-14 16:14:15,053 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 16:14:15,054 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 16:14:15,054 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/fca_adata.h5ad
2025-03-14 16:14:15,054 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 16:14:15,054 - INFO - Loading data files...
2025-03-14 16:14:15,581 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 16:15:13,875 - INFO - Using 1234 shared genes
2025-03-14 16:16:35,962 - INFO - Reference dataset loaded: (62515, 2431) (cells × genes)
2025-03-14 16:16:35,972 - INFO - Number of shared genes: 1234
2025-03-14 16:16:35,973 - INFO - Preprocessing datasets...
2025-03-14 16:18:15,300 - INFO - Using 1234 shared genes
2025-03-14 17:10:59,116 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 17:10:59,119 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 17:10:59,119 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/fca_adata.h5ad
2025-03-14 17:10:59,120 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 17:10:59,120 - INFO - Loading data files...
2025-03-14 17:10:59,648 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 17:11:41,148 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 17:11:41,149 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 17:11:41,149 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-14 17:11:41,149 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 17:11:41,149 - INFO - Loading data files...
2025-03-14 17:11:41,349 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 17:15:34,584 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-14 17:15:34,603 - INFO - Number of shared genes: 10618
2025-03-14 17:15:34,603 - INFO - Preprocessing datasets...
2025-03-14 17:19:53,411 - INFO - Using 10618 shared genes
2025-03-14 17:26:04,223 - INFO - Integrating datasets...
2025-03-14 17:30:08,938 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-14 17:30:08,939 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-14 17:30:08,940 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-14 17:30:08,940 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v6
2025-03-14 17:30:08,940 - INFO - Loading data files...
2025-03-14 17:30:09,365 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-14 17:32:01,167 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-14 17:32:01,179 - INFO - Number of shared genes: 10618
2025-03-14 17:32:01,179 - INFO - Preprocessing datasets...
2025-03-14 17:39:19,379 - INFO - Using 10618 shared genes
2025-03-14 17:47:57,031 - INFO - Integrating datasets...
2025-03-14 17:47:58,393 - INFO - Combined dataset shape: (12822, 10618)
2025-03-14 17:48:01,659 - INFO - Applying BBKNN batch correction...
