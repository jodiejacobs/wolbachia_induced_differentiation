2025-03-11 14:40:39,969 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 14:41:36,101 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 14:41:36,101 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 14:41:36,104 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 14:41:36,104 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 14:41:36,106 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 14:41:36,106 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 14:41:36,107 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 14:41:36,107 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 14:41:36,109 - INFO - Loading data files...
2025-03-11 14:41:36,109 - INFO - Loading data files...
2025-03-11 14:41:36,836 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 14:41:36,836 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 14:43:39,292 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 14:43:39,292 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 14:43:39,303 - INFO - Number of shared genes: 1234
2025-03-11 14:43:39,303 - INFO - Number of shared genes: 1234
2025-03-11 14:43:39,304 - INFO - Preprocessing datasets...
2025-03-11 14:43:39,304 - INFO - Preprocessing datasets...
2025-03-11 14:45:25,975 - INFO - Using 1234 shared genes
2025-03-11 14:45:25,975 - INFO - Using 1234 shared genes
2025-03-11 14:47:31,979 - INFO - Integrating datasets...
2025-03-11 14:47:31,979 - INFO - Integrating datasets...
2025-03-11 14:47:38,547 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 14:47:38,547 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 14:47:38,549 - INFO - Data is already normalized and log-transformed
2025-03-11 14:47:38,549 - INFO - Data is already normalized and log-transformed
2025-03-11 14:47:38,628 - INFO - Applying MNN batch correction...
2025-03-11 14:47:38,628 - INFO - Applying MNN batch correction...
2025-03-11 14:47:38,630 - INFO - MNN batch correction completed
2025-03-11 14:47:38,630 - INFO - MNN batch correction completed
2025-03-11 14:47:38,631 - INFO - Performing kNN classification with k=20...
2025-03-11 14:47:38,631 - INFO - Performing kNN classification with k=20...
2025-03-11 14:47:38,632 - ERROR - Integration pipeline failed: 'tuple' object has no attribute 'obs'
2025-03-11 14:47:38,632 - ERROR - Integration pipeline failed: 'tuple' object has no attribute 'obs'
2025-03-11 14:47:38,635 - ERROR - Traceback (most recent call last):
  File "/data/tmp/ipykernel_3552253/3703527236.py", line 26, in main
    results_df, annotated_adata = kNN_classifier(
  File "/data/tmp/ipykernel_3552253/1621663136.py", line 148, in kNN_classifier
    ref_indices = combined_adata.obs["dataset"] == "reference"
AttributeError: 'tuple' object has no attribute 'obs'

2025-03-11 14:47:38,635 - ERROR - Traceback (most recent call last):
  File "/data/tmp/ipykernel_3552253/3703527236.py", line 26, in main
    results_df, annotated_adata = kNN_classifier(
  File "/data/tmp/ipykernel_3552253/1621663136.py", line 148, in kNN_classifier
    ref_indices = combined_adata.obs["dataset"] == "reference"
AttributeError: 'tuple' object has no attribute 'obs'

2025-03-11 15:22:04,532 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 15:22:04,534 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 15:22:04,535 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 15:22:04,536 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 15:22:04,537 - INFO - Loading data files...
2025-03-11 15:22:04,773 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 15:24:42,283 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 15:24:42,297 - INFO - Number of shared genes: 1234
2025-03-11 15:24:42,298 - INFO - Preprocessing datasets...
2025-03-11 15:26:38,709 - INFO - Using 1234 shared genes
2025-03-11 15:26:51,365 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 15:26:51,366 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 15:26:51,366 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 15:26:51,366 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 15:26:51,366 - INFO - Loading data files...
2025-03-11 15:26:51,981 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 15:28:31,078 - INFO - Integrating datasets...
2025-03-11 15:28:31,896 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:28:31,898 - INFO - Data is already normalized and log-transformed
2025-03-11 15:28:32,127 - INFO - Applying MNN batch correction...
2025-03-11 15:28:32,128 - INFO - MNN batch correction completed
2025-03-11 15:28:32,129 - INFO - Performing kNN classification with k=20...
2025-03-11 15:28:32,130 - ERROR - Integration pipeline failed: 'tuple' object has no attribute 'obs'
2025-03-11 15:28:32,133 - ERROR - Traceback (most recent call last):
  File "/data/tmp/ipykernel_3567120/3703527236.py", line 26, in main
    results_df, annotated_adata = kNN_classifier(
  File "/data/tmp/ipykernel_3567120/1621663136.py", line 148, in kNN_classifier
    ref_indices = combined_adata.obs["dataset"] == "reference"
AttributeError: 'tuple' object has no attribute 'obs'

2025-03-11 15:28:53,887 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 15:28:53,892 - INFO - Number of shared genes: 1234
2025-03-11 15:28:53,893 - INFO - Preprocessing datasets...
2025-03-11 15:30:36,131 - INFO - Using 1234 shared genes
2025-03-11 15:32:23,543 - INFO - Integrating datasets...
2025-03-11 15:32:23,916 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:32:23,916 - INFO - Data is already normalized and log-transformed
2025-03-11 15:32:24,077 - INFO - Applying MNN batch correction...
2025-03-11 15:32:24,078 - INFO - MNN batch correction completed
2025-03-11 15:32:24,078 - INFO - Performing kNN classification with k=20...
2025-03-11 15:32:24,078 - ERROR - Integration pipeline failed: 'tuple' object has no attribute 'obs'
2025-03-11 15:32:24,081 - ERROR - Traceback (most recent call last):
  File "/private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/test_script.py", line 371, in main
    results_df, annotated_adata = kNN_classifier(
                                  ^^^^^^^^^^^^^^^
  File "/private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/test_script.py", line 210, in kNN_classifier
    ref_indices = combined_adata.obs["dataset"] == "reference"
                  ^^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'obs'

2025-03-11 15:35:13,596 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 15:35:13,617 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 15:35:13,618 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 15:35:13,620 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 15:35:13,621 - INFO - Loading data files...
2025-03-11 15:35:13,821 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 15:37:39,999 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 15:37:39,999 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 15:37:40,002 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 15:37:40,002 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 15:37:40,004 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 15:37:40,004 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-11 15:37:40,005 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 15:37:40,005 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 15:37:40,007 - INFO - Loading data files...
2025-03-11 15:37:40,007 - INFO - Loading data files...
2025-03-11 15:37:40,389 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 15:37:40,389 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 15:39:33,581 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 15:39:33,581 - INFO - Reference dataset loaded: (5000, 2431) (cells × genes)
2025-03-11 15:39:33,593 - INFO - Number of shared genes: 1234
2025-03-11 15:39:33,593 - INFO - Number of shared genes: 1234
2025-03-11 15:39:33,594 - INFO - Preprocessing datasets...
2025-03-11 15:39:33,594 - INFO - Preprocessing datasets...
2025-03-11 15:41:14,327 - INFO - Using 1234 shared genes
2025-03-11 15:41:14,327 - INFO - Using 1234 shared genes
2025-03-11 15:42:56,383 - INFO - Integrating datasets...
2025-03-11 15:42:56,383 - INFO - Integrating datasets...
2025-03-11 15:43:04,281 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:43:04,281 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:43:04,284 - INFO - Data is already normalized and log-transformed
2025-03-11 15:43:04,284 - INFO - Data is already normalized and log-transformed
2025-03-11 15:43:04,381 - INFO - Applying MNN batch correction...
2025-03-11 15:43:04,381 - INFO - Applying MNN batch correction...
2025-03-11 15:43:04,382 - INFO - MNN batch correction completed
2025-03-11 15:43:04,382 - INFO - MNN batch correction completed
2025-03-11 15:43:04,413 - INFO - Performing kNN classification with k=20...
2025-03-11 15:43:04,413 - INFO - Performing kNN classification with k=20...
2025-03-11 15:43:41,434 - INFO - Performing kNN classification with k=20...
2025-03-11 15:43:41,434 - INFO - Performing kNN classification with k=20...
2025-03-11 15:46:15,531 - INFO - Integrating datasets...
2025-03-11 15:46:15,531 - INFO - Integrating datasets...
2025-03-11 15:46:15,709 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:46:15,709 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:46:15,711 - INFO - Data is already normalized and log-transformed
2025-03-11 15:46:15,711 - INFO - Data is already normalized and log-transformed
2025-03-11 15:46:15,798 - INFO - Applying MNN batch correction...
2025-03-11 15:46:15,798 - INFO - Applying MNN batch correction...
2025-03-11 15:46:15,800 - INFO - MNN batch correction completed
2025-03-11 15:46:15,800 - INFO - MNN batch correction completed
2025-03-11 15:47:43,814 - INFO - Integrating datasets...
2025-03-11 15:47:43,814 - INFO - Integrating datasets...
2025-03-11 15:47:44,077 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:47:44,077 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 15:47:44,078 - INFO - Data is already normalized and log-transformed
2025-03-11 15:47:44,078 - INFO - Data is already normalized and log-transformed
2025-03-11 15:47:44,172 - INFO - Applying MNN batch correction...
2025-03-11 15:47:44,172 - INFO - Applying MNN batch correction...
2025-03-11 15:47:44,174 - INFO - MNN batch correction completed
2025-03-11 15:47:44,174 - INFO - MNN batch correction completed
2025-03-11 16:06:08,371 - INFO - Integrating datasets...
2025-03-11 16:06:08,371 - INFO - Integrating datasets...
2025-03-11 16:06:08,538 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:08,538 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:08,540 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:08,540 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:08,633 - INFO - Applying MNN batch correction...
2025-03-11 16:06:08,633 - INFO - Applying MNN batch correction...
2025-03-11 16:06:08,635 - INFO - MNN batch correction completed
2025-03-11 16:06:08,635 - INFO - MNN batch correction completed
2025-03-11 16:06:18,043 - INFO - Integrating datasets...
2025-03-11 16:06:18,043 - INFO - Integrating datasets...
2025-03-11 16:06:18,195 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:18,195 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:18,196 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:18,196 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:18,284 - INFO - Applying MNN batch correction...
2025-03-11 16:06:18,284 - INFO - Applying MNN batch correction...
2025-03-11 16:06:18,285 - INFO - MNN batch correction completed
2025-03-11 16:06:18,285 - INFO - MNN batch correction completed
2025-03-11 16:06:20,762 - INFO - Performing kNN classification with k=20...
2025-03-11 16:06:20,762 - INFO - Performing kNN classification with k=20...
2025-03-11 16:06:24,522 - INFO - Performing kNN classification with k=20...
2025-03-11 16:06:24,522 - INFO - Performing kNN classification with k=20...
2025-03-11 16:06:32,531 - INFO - Integrating datasets...
2025-03-11 16:06:32,531 - INFO - Integrating datasets...
2025-03-11 16:06:32,689 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:32,689 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:32,691 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:32,691 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:32,776 - INFO - Applying MNN batch correction...
2025-03-11 16:06:32,776 - INFO - Applying MNN batch correction...
2025-03-11 16:06:32,777 - INFO - MNN batch correction completed
2025-03-11 16:06:32,777 - INFO - MNN batch correction completed
2025-03-11 16:06:43,165 - INFO - Integrating datasets...
2025-03-11 16:06:43,165 - INFO - Integrating datasets...
2025-03-11 16:06:43,322 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:43,322 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:43,324 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:43,324 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:43,412 - INFO - Applying MNN batch correction...
2025-03-11 16:06:43,412 - INFO - Applying MNN batch correction...
2025-03-11 16:06:43,413 - INFO - MNN batch correction completed
2025-03-11 16:06:43,413 - INFO - MNN batch correction completed
2025-03-11 16:06:55,715 - INFO - Integrating datasets...
2025-03-11 16:06:55,715 - INFO - Integrating datasets...
2025-03-11 16:06:55,869 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:55,869 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:06:55,871 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:55,871 - INFO - Data is already normalized and log-transformed
2025-03-11 16:06:55,958 - INFO - Applying MNN batch correction...
2025-03-11 16:06:55,958 - INFO - Applying MNN batch correction...
2025-03-11 16:06:55,960 - INFO - MNN batch correction completed
2025-03-11 16:06:55,960 - INFO - MNN batch correction completed
2025-03-11 16:07:13,491 - INFO - Integrating datasets...
2025-03-11 16:07:13,491 - INFO - Integrating datasets...
2025-03-11 16:07:13,650 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:07:13,650 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:07:13,652 - INFO - Data is already normalized and log-transformed
2025-03-11 16:07:13,652 - INFO - Data is already normalized and log-transformed
2025-03-11 16:07:13,755 - INFO - Applying MNN batch correction...
2025-03-11 16:07:13,755 - INFO - Applying MNN batch correction...
2025-03-11 16:07:13,756 - INFO - MNN batch correction completed
2025-03-11 16:07:13,756 - INFO - MNN batch correction completed
2025-03-11 16:07:19,235 - INFO - Integrating datasets...
2025-03-11 16:07:19,235 - INFO - Integrating datasets...
2025-03-11 16:07:19,390 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:07:19,390 - INFO - Combined dataset shape: (5024, 1234)
2025-03-11 16:07:19,392 - INFO - Data is already normalized and log-transformed
2025-03-11 16:07:19,392 - INFO - Data is already normalized and log-transformed
2025-03-11 16:07:19,479 - INFO - Applying MNN batch correction...
2025-03-11 16:07:19,479 - INFO - Applying MNN batch correction...
2025-03-11 16:07:19,481 - INFO - MNN batch correction completed
2025-03-11 16:07:19,481 - INFO - MNN batch correction completed
2025-03-11 16:07:25,807 - INFO - Performing kNN classification with k=20...
2025-03-11 16:07:25,807 - INFO - Performing kNN classification with k=20...
2025-03-11 16:07:25,812 - INFO - Reference cells: 5000, Bulk samples: 24
2025-03-11 16:07:25,812 - INFO - Reference cells: 5000, Bulk samples: 24
2025-03-11 16:07:27,485 - INFO - kNN classification completed
2025-03-11 16:07:27,485 - INFO - kNN classification completed
2025-03-11 16:07:39,326 - INFO - Performing kNN classification with k=20...
2025-03-11 16:07:39,326 - INFO - Performing kNN classification with k=20...
2025-03-11 16:07:39,329 - INFO - Reference cells: 5000, Bulk samples: 24
2025-03-11 16:07:39,329 - INFO - Reference cells: 5000, Bulk samples: 24
2025-03-11 16:07:41,001 - INFO - kNN classification completed
2025-03-11 16:07:41,001 - INFO - kNN classification completed
2025-03-11 16:07:41,004 - INFO - Generating UMAP visualizations...
2025-03-11 16:07:41,004 - INFO - Generating UMAP visualizations...
2025-03-11 16:09:23,811 - INFO - UMAP visualizations completed
2025-03-11 16:09:23,811 - INFO - UMAP visualizations completed
2025-03-11 16:09:24,325 - INFO - Integration pipeline completed successfully
2025-03-11 16:09:24,325 - INFO - Integration pipeline completed successfully
2025-03-11 16:09:24,326 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 16:09:24,326 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 16:11:16,242 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:11:16,242 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:11:16,242 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:11:16,585 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:11:16,585 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:11:16,585 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:11:16,586 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_all.h5ad
2025-03-11 16:11:16,586 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_all.h5ad
2025-03-11 16:11:16,586 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_all.h5ad
2025-03-11 16:11:16,588 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 16:11:16,588 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 16:11:16,588 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/output
2025-03-11 16:11:16,589 - INFO - Loading data files...
2025-03-11 16:11:16,589 - INFO - Loading data files...
2025-03-11 16:11:16,589 - INFO - Loading data files...
2025-03-11 16:11:16,732 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:11:16,732 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:11:16,732 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:11:47,651 - ERROR - Error loading reference data: "Unable to synchronously open object (object 'obs' doesn't exist)"
2025-03-11 16:11:47,651 - ERROR - Error loading reference data: "Unable to synchronously open object (object 'obs' doesn't exist)"
2025-03-11 16:11:47,651 - ERROR - Error loading reference data: "Unable to synchronously open object (object 'obs' doesn't exist)"
2025-03-11 16:12:49,807 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:12:49,807 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:12:49,807 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 16:12:49,810 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:12:49,810 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:12:49,810 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 16:12:49,812 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 16:12:49,812 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 16:12:49,812 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 16:12:49,813 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 16:12:49,813 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 16:12:49,813 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 16:12:49,815 - INFO - Loading data files...
2025-03-11 16:12:49,815 - INFO - Loading data files...
2025-03-11 16:12:49,815 - INFO - Loading data files...
2025-03-11 16:12:49,962 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:12:49,962 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:12:49,962 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 16:17:17,758 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 16:17:17,758 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 16:17:17,758 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 16:17:17,783 - INFO - Number of shared genes: 10618
2025-03-11 16:17:17,783 - INFO - Number of shared genes: 10618
2025-03-11 16:17:17,783 - INFO - Number of shared genes: 10618
2025-03-11 16:17:17,788 - INFO - Preprocessing datasets...
2025-03-11 16:17:17,788 - INFO - Preprocessing datasets...
2025-03-11 16:17:17,788 - INFO - Preprocessing datasets...
2025-03-11 16:25:58,094 - INFO - Using 10618 shared genes
2025-03-11 16:25:58,094 - INFO - Using 10618 shared genes
2025-03-11 16:25:58,094 - INFO - Using 10618 shared genes
2025-03-11 17:12:12,283 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 17:12:12,283 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 17:12:12,283 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-11 17:12:12,297 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:12:12,297 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:12:12,297 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:12:12,298 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 17:12:12,298 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 17:12:12,298 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 17:12:12,300 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 17:12:12,300 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 17:12:12,300 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas
2025-03-11 17:12:12,302 - INFO - Loading data files...
2025-03-11 17:12:12,302 - INFO - Loading data files...
2025-03-11 17:12:12,302 - INFO - Loading data files...
2025-03-11 17:12:12,475 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 17:12:12,475 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 17:12:12,475 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-11 17:15:02,718 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 17:15:02,718 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 17:15:02,718 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 17:15:02,741 - INFO - Number of shared genes: 10618
2025-03-11 17:15:02,741 - INFO - Number of shared genes: 10618
2025-03-11 17:15:02,741 - INFO - Number of shared genes: 10618
2025-03-11 17:15:02,743 - INFO - Preprocessing datasets...
2025-03-11 17:15:02,743 - INFO - Preprocessing datasets...
2025-03-11 17:15:02,743 - INFO - Preprocessing datasets...
2025-03-11 17:28:37,096 - INFO - Using 10618 shared genes
2025-03-11 17:28:37,096 - INFO - Using 10618 shared genes
2025-03-11 17:28:37,096 - INFO - Using 10618 shared genes
2025-03-11 17:57:52,635 - INFO - Integrating datasets...
2025-03-11 17:57:52,635 - INFO - Integrating datasets...
2025-03-11 17:57:52,635 - INFO - Integrating datasets...
2025-03-11 17:59:25,088 - INFO - Combined dataset shape: (502704, 10618)
2025-03-11 17:59:25,088 - INFO - Combined dataset shape: (502704, 10618)
2025-03-11 17:59:25,088 - INFO - Combined dataset shape: (502704, 10618)
2025-03-11 17:59:25,121 - INFO - Data is already normalized and log-transformed
2025-03-11 17:59:25,121 - INFO - Data is already normalized and log-transformed
2025-03-11 17:59:25,121 - INFO - Data is already normalized and log-transformed
2025-03-11 18:04:29,865 - INFO - Applying MNN batch correction...
2025-03-11 18:04:29,865 - INFO - Applying MNN batch correction...
2025-03-11 18:04:29,865 - INFO - Applying MNN batch correction...
2025-03-11 18:04:30,236 - INFO - MNN batch correction completed
2025-03-11 18:04:30,236 - INFO - MNN batch correction completed
2025-03-11 18:04:30,236 - INFO - MNN batch correction completed
2025-03-11 18:04:30,285 - INFO - Performing kNN classification with k=20...
2025-03-11 18:04:30,285 - INFO - Performing kNN classification with k=20...
2025-03-11 18:04:30,285 - INFO - Performing kNN classification with k=20...
2025-03-11 18:04:30,424 - INFO - Reference cells: 502680, Bulk samples: 24
2025-03-11 18:04:30,424 - INFO - Reference cells: 502680, Bulk samples: 24
2025-03-11 18:04:30,424 - INFO - Reference cells: 502680, Bulk samples: 24
2025-03-11 18:38:17,736 - INFO - kNN classification completed
2025-03-11 18:38:17,736 - INFO - kNN classification completed
2025-03-11 18:38:17,736 - INFO - kNN classification completed
2025-03-11 18:38:19,441 - INFO - Generating UMAP visualizations...
2025-03-11 18:38:19,441 - INFO - Generating UMAP visualizations...
2025-03-11 18:38:19,441 - INFO - Generating UMAP visualizations...
