2025-03-17 13:41:23,076 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 13:41:23,076 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 13:41:23,076 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 13:41:23,077 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:41:23,077 - INFO - Loading data files...
2025-03-17 13:41:23,258 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 13:41:23,602 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 13:41:23,611 - INFO - Number of shared genes: 8325
2025-03-17 13:41:23,612 - INFO - Preprocessing datasets...
2025-03-17 13:41:24,019 - INFO - Using 8325 shared genes
2025-03-17 13:41:25,978 - INFO - Integrating datasets...
2025-03-17 13:41:26,068 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 13:41:26,210 - INFO - Applying BBKNN batch correction...
2025-03-17 13:49:28,762 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 13:49:28,763 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 13:49:28,764 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 13:49:28,765 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:49:28,766 - INFO - Loading data files...
2025-03-17 13:49:29,312 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 13:49:30,025 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 13:49:30,066 - INFO - Number of shared genes: 8325
2025-03-17 13:49:30,067 - INFO - Preprocessing datasets...
2025-03-17 13:49:30,554 - INFO - Using 8325 shared genes
2025-03-17 13:49:35,290 - INFO - Integrating datasets...
2025-03-17 13:49:35,293 - INFO - Combining datasets...
2025-03-17 13:49:35,582 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 13:49:35,583 - INFO - Data is already normalized and log-transformed
2025-03-17 13:49:35,794 - INFO - Computing PCA...
2025-03-17 13:50:54,836 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 13:50:54,837 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 13:50:54,837 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 13:50:54,837 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:50:54,837 - INFO - Loading data files...
2025-03-17 13:50:54,972 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 13:50:55,194 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 13:50:55,201 - INFO - Number of shared genes: 8325
2025-03-17 13:50:55,201 - INFO - Preprocessing datasets...
2025-03-17 13:50:55,482 - INFO - Using 8325 shared genes
2025-03-17 13:50:56,769 - INFO - Integrating datasets...
2025-03-17 13:50:56,770 - INFO - Combining datasets...
2025-03-17 13:50:56,839 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 13:50:56,840 - INFO - Data is already normalized and log-transformed
2025-03-17 13:50:56,927 - INFO - Computing PCA...
2025-03-17 13:51:02,202 - INFO - Applying BBKNN batch correction...
2025-03-17 13:51:07,048 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 13:51:07,048 - INFO - Performing kNN classification with k=6...
2025-03-17 13:51:07,049 - ERROR - Annotation key 'subtypes' not found in combined data
2025-03-17 13:51:07,049 - ERROR - Available columns: ['n_genes', 'dataset']
2025-03-17 13:51:07,049 - WARNING - Using 'dataset' as fallback annotation key
2025-03-17 13:51:07,051 - INFO - Sample values from 'dataset': []
2025-03-17 13:51:07,053 - INFO - Successfully extracted 0 reference labels
2025-03-17 13:51:07,054 - INFO - Reference cells: 0, Bulk samples: 0
2025-03-17 13:51:07,054 - INFO - Using PCA embeddings for kNN search
2025-03-17 13:51:07,055 - INFO - kNN classification completed for all 0 bulk samples
2025-03-17 13:51:07,055 - INFO - Classification summary:
2025-03-17 13:54:27,386 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 13:54:27,388 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 13:54:27,388 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 13:54:27,388 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:54:27,389 - INFO - Loading data files...
2025-03-17 13:54:27,540 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 13:54:27,775 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 13:54:27,782 - INFO - Number of shared genes: 8325
2025-03-17 13:54:27,782 - INFO - Preprocessing datasets...
2025-03-17 13:54:27,955 - INFO - Using 8325 shared genes
2025-03-17 13:54:29,671 - INFO - Integrating datasets...
2025-03-17 13:54:29,774 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 13:54:29,775 - INFO - Data is already normalized and log-transformed
2025-03-17 13:54:29,873 - INFO - Applying BBKNN batch correction...
2025-03-17 13:54:36,249 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 13:54:36,249 - INFO - Performing kNN classification with k=6...
2025-03-17 13:54:36,250 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 13:54:36,260 - INFO - Successfully extracted 780 reference labels
2025-03-17 13:54:36,260 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 13:54:36,260 - INFO - Using UMAP embeddings for kNN search
2025-03-17 13:54:36,261 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 13:54:36,737 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 13:54:37,185 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 13:54:37,684 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 13:54:38,145 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 13:54:38,568 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 13:54:39,020 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 13:54:39,472 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 13:54:39,926 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 13:54:40,389 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 13:54:40,813 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 13:54:41,261 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 13:54:41,718 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 13:54:42,170 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 13:54:42,624 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 13:54:43,074 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 13:54:43,516 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 13:54:43,974 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 13:54:44,405 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 13:54:44,842 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 13:54:45,294 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 13:54:45,740 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 13:54:46,132 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 13:54:46,483 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 13:54:46,834 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 13:54:46,834 - INFO - Classification summary:
2025-03-17 13:54:46,836 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 13:54:46,836 - INFO - P-value summary:
2025-03-17 13:54:46,836 - INFO -   Mean p-value: 1.0000
2025-03-17 13:54:46,837 - INFO -   Median p-value: 1.0000
2025-03-17 13:54:46,837 - INFO -   Min p-value: 1.0000
2025-03-17 13:54:46,838 - INFO -   Max p-value: 1.0000
2025-03-17 13:54:46,838 - INFO - Generating UMAP visualizations...
2025-03-17 13:55:07,378 - INFO - UMAP visualizations completed
2025-03-17 13:55:07,684 - INFO - Integration pipeline completed successfully
2025-03-17 13:55:07,685 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:55:07,685 - INFO - Plotting UMAP...
2025-03-17 13:58:15,603 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 13:58:15,603 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 13:58:15,603 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 13:58:15,603 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:58:15,604 - INFO - Loading data files...
2025-03-17 13:58:15,815 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 13:58:16,097 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 13:58:16,108 - INFO - Number of shared genes: 8325
2025-03-17 13:58:16,109 - INFO - Preprocessing datasets...
2025-03-17 13:58:16,908 - INFO - Using 8325 shared genes
2025-03-17 13:58:18,644 - INFO - Integrating datasets...
2025-03-17 13:58:18,759 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 13:58:18,759 - INFO - Data is already normalized and log-transformed
2025-03-17 13:58:18,876 - INFO - Applying BBKNN batch correction...
2025-03-17 13:58:25,578 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 13:58:25,578 - INFO - Performing kNN classification with k=6...
2025-03-17 13:58:25,581 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 13:58:25,593 - INFO - Successfully extracted 780 reference labels
2025-03-17 13:58:25,594 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 13:58:25,594 - INFO - Using UMAP embeddings for kNN search
2025-03-17 13:58:25,594 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 13:58:26,115 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 13:58:26,558 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 13:58:27,048 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 13:58:27,493 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 13:58:27,923 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 13:58:28,370 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 13:58:28,824 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 13:58:29,268 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 13:58:29,701 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 13:58:30,133 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 13:58:30,584 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 13:58:31,016 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 13:58:31,496 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 13:58:31,948 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 13:58:32,390 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 13:58:32,811 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 13:58:33,304 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 13:58:33,754 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 13:58:34,206 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 13:58:34,642 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 13:58:35,074 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 13:58:35,527 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 13:58:35,974 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 13:58:36,415 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 13:58:36,416 - INFO - Classification summary:
2025-03-17 13:58:36,419 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 13:58:36,419 - INFO - P-value summary:
2025-03-17 13:58:36,420 - INFO -   Mean p-value: 1.0000
2025-03-17 13:58:36,421 - INFO -   Median p-value: 1.0000
2025-03-17 13:58:36,421 - INFO -   Min p-value: 1.0000
2025-03-17 13:58:36,422 - INFO -   Max p-value: 1.0000
2025-03-17 13:58:36,422 - INFO - Generating UMAP visualizations...
2025-03-17 13:59:01,275 - INFO - UMAP visualizations completed
2025-03-17 13:59:01,649 - INFO - Integration pipeline completed successfully
2025-03-17 13:59:01,650 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 13:59:01,650 - INFO - Plotting UMAP...
2025-03-17 14:04:14,987 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:04:14,988 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:04:14,988 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:04:14,988 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:04:14,988 - INFO - Loading data files...
2025-03-17 14:04:15,127 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:04:15,349 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:04:15,354 - INFO - Number of shared genes: 8325
2025-03-17 14:04:15,354 - INFO - Preprocessing datasets...
2025-03-17 14:04:16,003 - INFO - Using 8325 shared genes
2025-03-17 14:04:17,278 - INFO - Integrating datasets...
2025-03-17 14:04:17,365 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:04:17,365 - INFO - Data is already normalized and log-transformed
2025-03-17 14:04:17,464 - INFO - Applying MNN batch correction...
2025-03-17 14:05:41,337 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:05:41,338 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:05:41,339 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:05:41,339 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:05:41,339 - INFO - Loading data files...
2025-03-17 14:05:41,475 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:05:41,697 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:05:41,703 - INFO - Number of shared genes: 8325
2025-03-17 14:05:41,703 - INFO - Preprocessing datasets...
2025-03-17 14:05:42,375 - INFO - Using 8325 shared genes
2025-03-17 14:05:43,658 - INFO - Integrating datasets...
2025-03-17 14:05:43,746 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:05:43,746 - INFO - Data is already normalized and log-transformed
2025-03-17 14:05:43,841 - INFO - Applying MNN batch correction...
2025-03-17 14:05:43,843 - INFO - Batch categories: ['bulk', 'reference']
2025-03-17 14:05:43,897 - INFO - Running MNN correction...
2025-03-17 14:16:10,303 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:16:10,304 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:16:10,304 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:16:10,304 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:16:10,304 - INFO - Loading data files...
2025-03-17 14:16:10,445 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:16:10,671 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:16:10,676 - INFO - Number of shared genes: 8325
2025-03-17 14:16:10,676 - INFO - Preprocessing datasets...
2025-03-17 14:16:11,320 - INFO - Using 8325 shared genes
2025-03-17 14:16:12,584 - INFO - Integrating datasets...
2025-03-17 14:16:12,665 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:16:12,665 - INFO - Data is already normalized and log-transformed
2025-03-17 14:16:12,761 - INFO - Applying MNN batch correction...
2025-03-17 14:22:59,776 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:22:59,779 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:22:59,779 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:22:59,779 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:22:59,779 - INFO - Loading data files...
2025-03-17 14:22:59,915 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:23:00,147 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:23:00,153 - INFO - Number of shared genes: 8325
2025-03-17 14:23:00,154 - INFO - Preprocessing datasets...
2025-03-17 14:23:00,804 - INFO - Using 8325 shared genes
2025-03-17 14:23:02,153 - INFO - Integrating datasets...
2025-03-17 14:23:02,232 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:23:02,233 - INFO - Data is already normalized and log-transformed
2025-03-17 14:23:02,334 - INFO - Applying MNN batch correction...
2025-03-17 14:23:02,336 - INFO - Batch categories: ['bulk', 'reference']
2025-03-17 14:23:02,398 - INFO - Running MNN correction...
2025-03-17 14:25:16,722 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:25:16,724 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:25:16,724 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:25:16,724 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:25:16,724 - INFO - Loading data files...
2025-03-17 14:25:16,867 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:25:17,090 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:25:17,096 - INFO - Number of shared genes: 8325
2025-03-17 14:25:17,096 - INFO - Preprocessing datasets...
2025-03-17 14:25:17,746 - INFO - Using 8325 shared genes
2025-03-17 14:25:19,065 - INFO - Integrating datasets...
2025-03-17 14:25:19,145 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:25:19,145 - INFO - Data is already normalized and log-transformed
2025-03-17 14:25:19,231 - INFO - Applying MNN batch correction...
2025-03-17 14:25:19,233 - INFO - Batch categories: ['bulk', 'reference']
2025-03-17 14:25:19,289 - INFO - Running MNN correction...
2025-03-17 14:26:29,665 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:26:29,674 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:26:29,677 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:26:29,678 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:26:29,679 - INFO - Loading data files...
2025-03-17 14:26:29,816 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:26:30,029 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:26:30,038 - INFO - Number of shared genes: 8325
2025-03-17 14:26:30,041 - INFO - Preprocessing datasets...
2025-03-17 14:26:30,215 - INFO - Using 8325 shared genes
2025-03-17 14:26:33,888 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:26:34,313 - INFO - Integrating datasets...
2025-03-17 14:26:34,394 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:26:34,396 - INFO - Data is already normalized and log-transformed
2025-03-17 14:26:34,484 - INFO - Applying MNN batch correction...
2025-03-17 14:26:34,486 - INFO - MNN batch correction completed
2025-03-17 14:27:30,551 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:27:30,551 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:27:30,552 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:27:30,552 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:27:30,553 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:27:30,553 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:27:30,554 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:27:30,554 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:27:30,556 - INFO - Loading data files...
2025-03-17 14:27:30,556 - INFO - Loading data files...
2025-03-17 14:27:30,709 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:27:30,709 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:27:30,920 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:27:30,920 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:27:30,927 - INFO - Number of shared genes: 8325
2025-03-17 14:27:30,927 - INFO - Number of shared genes: 8325
2025-03-17 14:27:30,949 - INFO - Preprocessing datasets...
2025-03-17 14:27:30,949 - INFO - Preprocessing datasets...
2025-03-17 14:27:31,121 - INFO - Using 8325 shared genes
2025-03-17 14:27:31,121 - INFO - Using 8325 shared genes
2025-03-17 14:27:34,775 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:27:34,775 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:27:35,199 - INFO - Integrating datasets...
2025-03-17 14:27:35,199 - INFO - Integrating datasets...
2025-03-17 14:27:35,283 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:27:35,283 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:27:35,284 - INFO - Data is already normalized and log-transformed
2025-03-17 14:27:35,284 - INFO - Data is already normalized and log-transformed
2025-03-17 14:27:35,383 - INFO - Applying MNN batch correction...
2025-03-17 14:27:35,383 - INFO - Applying MNN batch correction...
2025-03-17 14:27:35,385 - INFO - MNN batch correction completed
2025-03-17 14:27:35,385 - INFO - MNN batch correction completed
2025-03-17 14:28:22,058 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:28:22,058 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:28:22,058 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:28:22,059 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:28:22,059 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:28:22,059 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:28:22,061 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:28:22,061 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:28:22,061 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:28:22,062 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:28:22,062 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:28:22,062 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:28:22,064 - INFO - Loading data files...
2025-03-17 14:28:22,064 - INFO - Loading data files...
2025-03-17 14:28:22,064 - INFO - Loading data files...
2025-03-17 14:28:22,212 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:28:22,212 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:28:22,212 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:28:22,423 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:28:22,423 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:28:22,423 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:28:22,431 - INFO - Number of shared genes: 8325
2025-03-17 14:28:22,431 - INFO - Number of shared genes: 8325
2025-03-17 14:28:22,431 - INFO - Number of shared genes: 8325
2025-03-17 14:28:22,455 - INFO - Preprocessing datasets...
2025-03-17 14:28:22,455 - INFO - Preprocessing datasets...
2025-03-17 14:28:22,455 - INFO - Preprocessing datasets...
2025-03-17 14:28:22,626 - INFO - Using 8325 shared genes
2025-03-17 14:28:22,626 - INFO - Using 8325 shared genes
2025-03-17 14:28:22,626 - INFO - Using 8325 shared genes
2025-03-17 14:28:26,272 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:28:26,272 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:28:26,272 - INFO - Concatenating 12 subsampled datasets
2025-03-17 14:28:26,733 - INFO - Integrating datasets...
2025-03-17 14:28:26,733 - INFO - Integrating datasets...
2025-03-17 14:28:26,733 - INFO - Integrating datasets...
2025-03-17 14:28:26,812 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:26,812 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:26,812 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:26,814 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:26,814 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:26,814 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:26,900 - INFO - Applying MNN batch correction...
2025-03-17 14:28:26,900 - INFO - Applying MNN batch correction...
2025-03-17 14:28:26,900 - INFO - Applying MNN batch correction...
2025-03-17 14:28:26,901 - INFO - MNN batch correction completed
2025-03-17 14:28:26,901 - INFO - MNN batch correction completed
2025-03-17 14:28:26,901 - INFO - MNN batch correction completed
2025-03-17 14:28:35,117 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 14:28:35,117 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 14:28:35,117 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 14:28:48,434 - INFO - Integrating datasets...
2025-03-17 14:28:48,434 - INFO - Integrating datasets...
2025-03-17 14:28:48,434 - INFO - Integrating datasets...
2025-03-17 14:28:48,504 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:48,504 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:48,504 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:28:48,506 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:48,506 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:48,506 - INFO - Data is already normalized and log-transformed
2025-03-17 14:28:48,579 - INFO - Applying MNN batch correction...
2025-03-17 14:28:48,579 - INFO - Applying MNN batch correction...
2025-03-17 14:28:48,579 - INFO - Applying MNN batch correction...
2025-03-17 14:28:48,580 - INFO - MNN batch correction completed
2025-03-17 14:28:48,580 - INFO - MNN batch correction completed
2025-03-17 14:28:48,580 - INFO - MNN batch correction completed
2025-03-17 14:52:43,754 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:52:43,755 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:52:43,756 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:52:43,756 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:52:43,756 - INFO - Loading data files...
2025-03-17 14:52:43,917 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:52:44,274 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:52:44,279 - INFO - Number of shared genes: 8325
2025-03-17 14:52:44,280 - INFO - Preprocessing datasets...
2025-03-17 14:52:44,925 - INFO - Using 8325 shared genes
2025-03-17 14:52:46,177 - INFO - Integrating datasets...
2025-03-17 14:52:46,267 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:52:46,268 - INFO - Data is already normalized and log-transformed
2025-03-17 14:52:46,362 - INFO - Applying MNN batch correction...
2025-03-17 14:52:46,364 - INFO - Batch categories: ['bulk', 'reference']
2025-03-17 14:52:46,416 - INFO - Running MNN correction...
2025-03-17 14:54:18,181 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 14:54:18,182 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 14:54:18,182 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 14:54:18,182 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:54:18,183 - INFO - Loading data files...
2025-03-17 14:54:18,352 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 14:54:18,723 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 14:54:18,728 - INFO - Number of shared genes: 8325
2025-03-17 14:54:18,728 - INFO - Preprocessing datasets...
2025-03-17 14:54:19,371 - INFO - Using 8325 shared genes
2025-03-17 14:54:20,635 - INFO - Integrating datasets...
2025-03-17 14:54:20,715 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 14:54:20,715 - INFO - Data is already normalized and log-transformed
2025-03-17 14:54:20,801 - INFO - Applying BBKNN batch correction...
2025-03-17 14:54:24,880 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 14:54:24,880 - INFO - Performing kNN classification with k=6...
2025-03-17 14:54:24,881 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 14:54:24,890 - INFO - Successfully extracted 780 reference labels
2025-03-17 14:54:24,890 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 14:54:24,891 - INFO - Using UMAP embeddings for kNN search
2025-03-17 14:54:24,891 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 14:54:25,247 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 14:54:25,579 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 14:54:25,937 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 14:54:26,276 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 14:54:26,618 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 14:54:26,950 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 14:54:27,283 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 14:54:27,616 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 14:54:27,946 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 14:54:28,278 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 14:54:28,614 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 14:54:28,964 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 14:54:29,298 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 14:54:29,633 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 14:54:29,961 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 14:54:30,304 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 14:54:30,636 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 14:54:30,971 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 14:54:31,311 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 14:54:31,641 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 14:54:31,972 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 14:54:32,306 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 14:54:32,637 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 14:54:32,969 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 14:54:32,969 - INFO - Classification summary:
2025-03-17 14:54:32,970 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 14:54:32,971 - INFO - P-value summary:
2025-03-17 14:54:32,971 - INFO -   Mean p-value: 1.0000
2025-03-17 14:54:32,971 - INFO -   Median p-value: 1.0000
2025-03-17 14:54:32,972 - INFO -   Min p-value: 1.0000
2025-03-17 14:54:32,972 - INFO -   Max p-value: 1.0000
2025-03-17 14:54:32,972 - INFO - Generating UMAP visualizations...
2025-03-17 14:54:50,253 - INFO - UMAP visualizations completed
2025-03-17 14:54:50,515 - INFO - Integration pipeline completed successfully
2025-03-17 14:54:50,516 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 14:54:50,516 - INFO - Plotting UMAP...
2025-03-17 15:01:00,713 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:01:00,714 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:01:00,714 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:01:00,715 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:01:00,715 - INFO - Loading data files...
2025-03-17 15:01:00,894 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:01:01,567 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:01:01,572 - INFO - Number of shared genes: 8325
2025-03-17 15:01:01,573 - INFO - Preprocessing datasets...
2025-03-17 15:01:02,213 - INFO - Using 8325 shared genes
2025-03-17 15:01:03,472 - INFO - Integrating datasets...
2025-03-17 15:01:03,552 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:01:03,552 - INFO - Data is already normalized and log-transformed
2025-03-17 15:01:03,638 - INFO - Applying BBKNN batch correction...
2025-03-17 15:01:07,737 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:01:07,737 - INFO - Performing kNN classification with k=6...
2025-03-17 15:01:07,738 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:01:07,748 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:01:07,748 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:01:07,748 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:01:07,748 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:01:08,104 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:01:08,435 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:01:08,766 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:01:09,097 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:01:09,427 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:01:09,794 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:01:10,134 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:01:10,465 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:01:10,800 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:01:11,145 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:01:11,481 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:01:11,816 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:01:12,152 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:01:12,482 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:01:12,814 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:01:13,149 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:01:13,478 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:01:13,809 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:01:14,139 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:01:14,473 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:01:14,804 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:01:15,134 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:01:15,464 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:01:15,810 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:01:15,810 - INFO - Classification summary:
2025-03-17 15:01:15,812 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:01:15,812 - INFO - P-value summary:
2025-03-17 15:01:15,813 - INFO -   Mean p-value: 1.0000
2025-03-17 15:01:15,813 - INFO -   Median p-value: 1.0000
2025-03-17 15:01:15,814 - INFO -   Min p-value: 1.0000
2025-03-17 15:01:15,814 - INFO -   Max p-value: 1.0000
2025-03-17 15:01:15,814 - INFO - Generating UMAP visualizations...
2025-03-17 15:01:33,158 - INFO - UMAP visualizations completed
2025-03-17 15:01:33,380 - INFO - Integration pipeline completed successfully
2025-03-17 15:01:33,381 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:01:33,381 - INFO - Plotting UMAP...
2025-03-17 15:02:26,807 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:02:26,807 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:02:26,807 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:02:26,807 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:02:26,807 - INFO - Loading data files...
2025-03-17 15:02:26,980 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:02:27,374 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:02:27,379 - INFO - Number of shared genes: 8325
2025-03-17 15:02:27,379 - INFO - Preprocessing datasets...
2025-03-17 15:02:28,027 - INFO - Using 8325 shared genes
2025-03-17 15:02:29,306 - INFO - Integrating datasets...
2025-03-17 15:02:29,390 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:02:29,390 - INFO - Data is already normalized and log-transformed
2025-03-17 15:02:29,477 - INFO - Applying BBKNN batch correction...
2025-03-17 15:02:33,601 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:02:33,601 - INFO - Performing kNN classification with k=6...
2025-03-17 15:02:33,602 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:02:33,611 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:02:33,612 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:02:33,612 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:02:33,612 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:02:33,971 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:02:34,310 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:02:34,669 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:02:35,022 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:02:35,358 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:02:35,702 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:02:36,051 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:02:36,396 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:02:36,734 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:02:37,075 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:02:37,414 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:02:37,756 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:02:38,102 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:02:38,445 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:02:38,784 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:02:39,127 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:02:39,466 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:02:39,804 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:02:40,151 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:02:40,497 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:02:40,837 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:02:41,178 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:02:41,516 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:02:41,855 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:02:41,855 - INFO - Classification summary:
2025-03-17 15:02:41,857 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:02:41,857 - INFO - P-value summary:
2025-03-17 15:02:41,857 - INFO -   Mean p-value: 1.0000
2025-03-17 15:02:41,858 - INFO -   Median p-value: 1.0000
2025-03-17 15:02:41,858 - INFO -   Min p-value: 1.0000
2025-03-17 15:02:41,858 - INFO -   Max p-value: 1.0000
2025-03-17 15:02:41,859 - INFO - Generating UMAP visualizations...
2025-03-17 15:02:59,819 - INFO - UMAP visualizations completed
2025-03-17 15:03:00,065 - INFO - Integration pipeline completed successfully
2025-03-17 15:03:00,066 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:03:00,066 - INFO - Plotting UMAP...
2025-03-17 15:03:24,981 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:03:24,981 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:03:24,981 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:03:24,981 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:03:24,982 - INFO - Loading data files...
2025-03-17 15:03:25,142 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:03:25,728 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:03:25,734 - INFO - Number of shared genes: 8325
2025-03-17 15:03:25,734 - INFO - Preprocessing datasets...
2025-03-17 15:03:26,399 - INFO - Using 8325 shared genes
2025-03-17 15:03:27,670 - INFO - Integrating datasets...
2025-03-17 15:03:27,751 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:03:27,752 - INFO - Data is already normalized and log-transformed
2025-03-17 15:03:27,843 - INFO - Applying BBKNN batch correction...
2025-03-17 15:03:32,034 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:03:32,035 - INFO - Performing kNN classification with k=6...
2025-03-17 15:03:32,036 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:03:32,045 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:03:32,046 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:03:32,046 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:03:32,046 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:03:32,421 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:03:32,765 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:03:33,107 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:03:33,449 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:03:33,809 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:03:34,156 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:03:34,500 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:03:34,845 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:03:35,188 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:03:35,533 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:03:35,874 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:03:36,239 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:03:36,583 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:03:36,924 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:03:37,264 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:03:37,607 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:03:37,951 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:03:38,293 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:03:38,638 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:03:38,993 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:03:39,362 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:03:39,701 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:03:40,047 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:03:40,396 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:03:40,396 - INFO - Classification summary:
2025-03-17 15:03:40,398 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:03:40,398 - INFO - P-value summary:
2025-03-17 15:03:40,398 - INFO -   Mean p-value: 1.0000
2025-03-17 15:03:40,399 - INFO -   Median p-value: 1.0000
2025-03-17 15:03:40,399 - INFO -   Min p-value: 1.0000
2025-03-17 15:03:40,399 - INFO -   Max p-value: 1.0000
2025-03-17 15:03:40,400 - INFO - Generating UMAP visualizations...
2025-03-17 15:03:58,081 - INFO - UMAP visualizations completed
2025-03-17 15:03:58,321 - INFO - Integration pipeline completed successfully
2025-03-17 15:03:58,322 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:03:58,322 - INFO - Plotting UMAP...
2025-03-17 15:06:46,396 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:06:46,397 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:06:46,397 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:06:46,398 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:06:46,398 - INFO - Loading data files...
2025-03-17 15:06:46,558 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:06:46,910 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:06:46,916 - INFO - Number of shared genes: 8325
2025-03-17 15:06:46,916 - INFO - Preprocessing datasets...
2025-03-17 15:06:47,564 - INFO - Using 8325 shared genes
2025-03-17 15:06:48,851 - INFO - Integrating datasets...
2025-03-17 15:06:48,933 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:06:48,934 - INFO - Data is already normalized and log-transformed
2025-03-17 15:06:49,023 - INFO - Applying BBKNN batch correction...
2025-03-17 15:06:53,194 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:06:53,194 - INFO - Performing kNN classification with k=6...
2025-03-17 15:06:53,196 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:06:53,206 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:06:53,207 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:06:53,207 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:06:53,207 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:06:53,579 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:06:53,931 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:06:54,276 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:06:54,621 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:06:54,967 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:06:55,311 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:06:55,657 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:06:56,004 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:06:56,352 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:06:56,699 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:06:57,047 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:06:57,392 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:06:57,737 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:06:58,082 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:06:58,431 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:06:58,775 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:06:59,120 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:06:59,465 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:06:59,823 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:07:00,178 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:07:00,519 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:07:00,867 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:07:01,212 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:07:01,561 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:07:01,561 - INFO - Classification summary:
2025-03-17 15:07:01,563 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:07:01,563 - INFO - P-value summary:
2025-03-17 15:07:01,564 - INFO -   Mean p-value: 1.0000
2025-03-17 15:07:01,564 - INFO -   Median p-value: 1.0000
2025-03-17 15:07:01,565 - INFO -   Min p-value: 1.0000
2025-03-17 15:07:01,565 - INFO -   Max p-value: 1.0000
2025-03-17 15:07:01,565 - INFO - Generating UMAP visualizations...
2025-03-17 15:07:19,556 - INFO - UMAP visualizations completed
2025-03-17 15:07:19,784 - INFO - Integration pipeline completed successfully
2025-03-17 15:07:19,784 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:07:19,784 - INFO - Plotting UMAP...
2025-03-17 15:08:40,588 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:08:40,685 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:08:40,685 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:08:40,685 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:08:40,685 - INFO - Loading data files...
2025-03-17 15:08:40,850 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:08:41,208 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:08:41,214 - INFO - Number of shared genes: 8325
2025-03-17 15:08:41,214 - INFO - Preprocessing datasets...
2025-03-17 15:08:41,862 - INFO - Using 8325 shared genes
2025-03-17 15:08:43,116 - INFO - Integrating datasets...
2025-03-17 15:08:43,204 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:08:43,204 - INFO - Data is already normalized and log-transformed
2025-03-17 15:08:43,298 - INFO - Applying BBKNN batch correction...
2025-03-17 15:08:47,389 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:08:47,389 - INFO - Performing kNN classification with k=6...
2025-03-17 15:08:47,390 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:08:47,399 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:08:47,399 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:08:47,400 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:08:47,400 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:08:47,759 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:08:48,093 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:08:48,425 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:08:48,760 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:08:49,091 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:08:49,459 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:08:49,790 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:08:50,126 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:08:50,461 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:08:50,804 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:08:51,143 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:08:51,480 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:08:51,814 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:08:52,147 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:08:52,479 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:08:52,813 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:08:53,146 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:08:53,478 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:08:53,809 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:08:54,145 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:08:54,477 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:08:54,809 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:08:55,147 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:08:55,482 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:08:55,483 - INFO - Classification summary:
2025-03-17 15:08:55,484 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:08:55,484 - INFO - P-value summary:
2025-03-17 15:08:55,485 - INFO -   Mean p-value: 1.0000
2025-03-17 15:08:55,485 - INFO -   Median p-value: 1.0000
2025-03-17 15:08:55,485 - INFO -   Min p-value: 1.0000
2025-03-17 15:08:55,486 - INFO -   Max p-value: 1.0000
2025-03-17 15:08:55,486 - INFO - Generating UMAP visualizations...
2025-03-17 15:09:13,827 - INFO - UMAP visualizations completed
2025-03-17 15:09:14,049 - INFO - Integration pipeline completed successfully
2025-03-17 15:09:14,049 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:09:14,049 - INFO - Plotting UMAP...
2025-03-17 15:10:43,043 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:10:43,122 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:10:43,123 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:10:43,123 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:10:43,123 - INFO - Loading data files...
2025-03-17 15:10:43,305 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:10:43,685 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:10:43,690 - INFO - Number of shared genes: 8325
2025-03-17 15:10:43,690 - INFO - Preprocessing datasets...
2025-03-17 15:10:44,336 - INFO - Using 8325 shared genes
2025-03-17 15:10:45,589 - INFO - Integrating datasets...
2025-03-17 15:10:45,669 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:10:45,670 - INFO - Data is already normalized and log-transformed
2025-03-17 15:10:45,756 - INFO - Applying BBKNN batch correction...
2025-03-17 15:10:49,819 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:10:49,819 - INFO - Performing kNN classification with k=6...
2025-03-17 15:10:49,820 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:10:49,829 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:10:49,830 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:10:49,830 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:10:49,830 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:10:50,207 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:10:50,544 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:10:50,883 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:10:51,227 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:10:51,565 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:10:51,933 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:10:52,270 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:10:52,603 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:10:52,936 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:10:53,275 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:10:53,613 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:10:53,956 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:10:54,292 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:10:54,625 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:10:54,962 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:10:55,294 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:10:55,627 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:10:55,965 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:10:56,304 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:10:56,640 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:10:56,974 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:10:57,306 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:10:57,642 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:10:57,983 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:10:57,984 - INFO - Classification summary:
2025-03-17 15:10:57,985 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:10:57,985 - INFO - P-value summary:
2025-03-17 15:10:57,986 - INFO -   Mean p-value: 1.0000
2025-03-17 15:10:57,986 - INFO -   Median p-value: 1.0000
2025-03-17 15:10:57,987 - INFO -   Min p-value: 1.0000
2025-03-17 15:10:57,987 - INFO -   Max p-value: 1.0000
2025-03-17 15:10:57,987 - INFO - Generating UMAP visualizations...
2025-03-17 15:11:15,451 - INFO - UMAP visualizations completed
2025-03-17 15:11:15,684 - INFO - Integration pipeline completed successfully
2025-03-17 15:11:15,685 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:11:15,685 - INFO - Plotting UMAP...
2025-03-17 15:14:05,668 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:14:05,738 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:14:05,738 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:14:05,738 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:14:05,738 - INFO - Loading data files...
2025-03-17 15:14:05,902 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:14:06,389 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:14:06,395 - INFO - Number of shared genes: 8325
2025-03-17 15:14:06,396 - INFO - Preprocessing datasets...
2025-03-17 15:14:07,044 - INFO - Using 8325 shared genes
2025-03-17 15:14:08,305 - INFO - Integrating datasets...
2025-03-17 15:14:08,385 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:14:08,386 - INFO - Data is already normalized and log-transformed
2025-03-17 15:14:08,472 - INFO - Applying BBKNN batch correction...
2025-03-17 15:14:12,724 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:14:12,724 - INFO - Performing kNN classification with k=6...
2025-03-17 15:14:12,726 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:14:12,735 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:14:12,736 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:14:12,736 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:14:12,736 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:14:13,115 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:14:13,467 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:14:13,821 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:14:14,181 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:14:14,557 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:14:14,935 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:14:15,287 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:14:15,654 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:14:15,990 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:14:16,328 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:14:16,666 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:14:17,002 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:14:17,339 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:14:17,679 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:14:18,015 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:14:18,353 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:14:18,693 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:14:19,047 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:14:19,399 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:14:19,737 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:14:20,082 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:14:20,427 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:14:20,768 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:14:21,109 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:14:21,109 - INFO - Classification summary:
2025-03-17 15:14:21,111 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:14:21,111 - INFO - P-value summary:
2025-03-17 15:14:21,111 - INFO -   Mean p-value: 1.0000
2025-03-17 15:14:21,112 - INFO -   Median p-value: 1.0000
2025-03-17 15:14:21,112 - INFO -   Min p-value: 1.0000
2025-03-17 15:14:21,112 - INFO -   Max p-value: 1.0000
2025-03-17 15:14:21,113 - INFO - Generating UMAP visualizations...
2025-03-17 15:14:39,233 - INFO - UMAP visualizations completed
2025-03-17 15:14:39,585 - INFO - Integration pipeline completed successfully
2025-03-17 15:14:39,585 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:14:39,585 - INFO - Plotting UMAP...
2025-03-17 15:53:25,250 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:53:25,252 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:53:25,252 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:53:25,252 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:53:25,252 - INFO - Loading data files...
2025-03-17 15:53:25,423 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:53:26,126 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:53:26,133 - INFO - Number of shared genes: 8325
2025-03-17 15:53:26,134 - INFO - Preprocessing datasets...
2025-03-17 15:53:26,780 - INFO - Using 8325 shared genes
2025-03-17 15:53:28,043 - INFO - Integrating datasets...
2025-03-17 15:53:28,124 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:53:28,125 - INFO - Data is already normalized and log-transformed
2025-03-17 15:53:28,212 - INFO - Applying BBKNN batch correction...
2025-03-17 15:53:32,315 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:53:32,315 - INFO - Performing kNN classification with k=6...
2025-03-17 15:53:32,317 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:53:32,327 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:53:32,327 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:53:32,327 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:53:32,327 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:53:32,685 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:53:33,019 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:53:33,351 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:53:33,683 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:53:34,017 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:53:34,378 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:53:34,722 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:53:35,054 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:53:35,387 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:53:35,719 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:53:36,058 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:53:36,401 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:53:36,737 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:53:37,069 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:53:37,406 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:53:37,740 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:53:38,073 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:53:38,406 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:53:38,738 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:53:39,070 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:53:39,402 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:53:39,734 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:53:40,071 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:53:40,411 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:53:40,411 - INFO - Classification summary:
2025-03-17 15:53:40,413 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:53:40,413 - INFO - P-value summary:
2025-03-17 15:53:40,413 - INFO -   Mean p-value: 1.0000
2025-03-17 15:53:40,414 - INFO -   Median p-value: 1.0000
2025-03-17 15:53:40,414 - INFO -   Min p-value: 1.0000
2025-03-17 15:53:40,415 - INFO -   Max p-value: 1.0000
2025-03-17 15:53:40,415 - INFO - Generating UMAP visualizations...
2025-03-17 15:53:59,514 - INFO - UMAP visualizations completed
2025-03-17 15:53:59,830 - INFO - Integration pipeline completed successfully
2025-03-17 15:53:59,830 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:53:59,831 - INFO - Plotting UMAP...
2025-03-17 15:54:57,283 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 15:54:57,284 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 15:54:57,284 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 15:54:57,284 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:54:57,284 - INFO - Loading data files...
2025-03-17 15:54:57,664 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 15:54:58,011 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 15:54:58,017 - INFO - Number of shared genes: 8325
2025-03-17 15:54:58,017 - INFO - Preprocessing datasets...
2025-03-17 15:54:58,664 - INFO - Using 8325 shared genes
2025-03-17 15:54:59,915 - INFO - Integrating datasets...
2025-03-17 15:55:00,001 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 15:55:00,002 - INFO - Data is already normalized and log-transformed
2025-03-17 15:55:00,097 - INFO - Applying BBKNN batch correction...
2025-03-17 15:55:04,155 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 15:55:04,156 - INFO - Performing kNN classification with k=6...
2025-03-17 15:55:04,157 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 15:55:04,166 - INFO - Successfully extracted 780 reference labels
2025-03-17 15:55:04,166 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 15:55:04,167 - INFO - Using UMAP embeddings for kNN search
2025-03-17 15:55:04,167 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 15:55:04,524 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 15:55:04,858 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 15:55:05,192 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 15:55:05,524 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 15:55:05,857 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 15:55:06,230 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 15:55:06,566 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 15:55:06,899 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 15:55:07,233 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 15:55:07,566 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 15:55:07,897 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 15:55:08,238 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 15:55:08,583 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 15:55:08,924 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 15:55:09,277 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 15:55:09,613 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 15:55:09,944 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 15:55:10,280 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 15:55:10,612 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 15:55:10,946 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 15:55:11,284 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 15:55:11,620 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 15:55:11,958 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 15:55:12,297 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 15:55:12,297 - INFO - Classification summary:
2025-03-17 15:55:12,298 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 15:55:12,299 - INFO - P-value summary:
2025-03-17 15:55:12,299 - INFO -   Mean p-value: 1.0000
2025-03-17 15:55:12,299 - INFO -   Median p-value: 1.0000
2025-03-17 15:55:12,300 - INFO -   Min p-value: 1.0000
2025-03-17 15:55:12,300 - INFO -   Max p-value: 1.0000
2025-03-17 15:55:12,300 - INFO - Generating UMAP visualizations...
2025-03-17 15:55:30,391 - INFO - UMAP visualizations completed
2025-03-17 15:55:31,017 - INFO - Integration pipeline completed successfully
2025-03-17 15:55:31,017 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 15:55:31,017 - INFO - Plotting UMAP...
2025-03-17 16:01:45,553 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 16:01:45,620 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 16:01:45,620 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 16:01:45,620 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 16:01:45,620 - INFO - Loading data files...
2025-03-17 16:01:45,784 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 16:01:46,172 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 16:01:46,177 - INFO - Number of shared genes: 8325
2025-03-17 16:01:46,177 - INFO - Preprocessing datasets...
2025-03-17 16:01:46,832 - INFO - Using 8325 shared genes
2025-03-17 16:01:48,144 - INFO - Integrating datasets...
2025-03-17 16:01:48,226 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 16:01:48,227 - INFO - Data is already normalized and log-transformed
2025-03-17 16:01:48,316 - INFO - Applying BBKNN batch correction...
2025-03-17 16:01:52,556 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 16:01:52,556 - INFO - Performing kNN classification with k=6...
2025-03-17 16:01:52,557 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 16:01:52,567 - INFO - Successfully extracted 780 reference labels
2025-03-17 16:01:52,567 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 16:01:52,567 - INFO - Using UMAP embeddings for kNN search
2025-03-17 16:01:52,567 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 16:01:52,940 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 16:01:53,296 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 16:01:53,666 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 16:01:54,025 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 16:01:54,381 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 16:01:54,739 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 16:01:55,094 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 16:01:55,434 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 16:01:55,771 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 16:01:56,115 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 16:01:56,456 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 16:01:56,793 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 16:01:57,138 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 16:01:57,477 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 16:01:57,814 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 16:01:58,153 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 16:01:58,491 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 16:01:58,830 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 16:01:59,173 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 16:01:59,523 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 16:01:59,864 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 16:02:00,204 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 16:02:00,546 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 16:02:00,888 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 16:02:00,888 - INFO - Classification summary:
2025-03-17 16:02:00,890 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 16:02:00,890 - INFO - P-value summary:
2025-03-17 16:02:00,890 - INFO -   Mean p-value: 1.0000
2025-03-17 16:02:00,891 - INFO -   Median p-value: 1.0000
2025-03-17 16:02:00,891 - INFO -   Min p-value: 1.0000
2025-03-17 16:02:00,892 - INFO -   Max p-value: 1.0000
2025-03-17 16:02:00,892 - INFO - Generating UMAP visualizations...
2025-03-17 16:02:18,910 - INFO - UMAP visualizations completed
2025-03-17 16:02:19,266 - INFO - Integration pipeline completed successfully
2025-03-17 16:02:19,266 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 16:02:19,266 - INFO - Plotting UMAP...
2025-03-17 16:10:10,685 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-17 16:10:10,752 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-17 16:10:10,752 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/combined_germline_sg_trachea.h5ad
2025-03-17 16:10:10,752 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 16:10:10,752 - INFO - Loading data files...
2025-03-17 16:10:10,892 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-17 16:10:11,465 - INFO - Reference dataset loaded: (3335, 10083) (cells × genes)
2025-03-17 16:10:11,472 - INFO - Number of shared genes: 8325
2025-03-17 16:10:11,472 - INFO - Preprocessing datasets...
2025-03-17 16:10:12,121 - INFO - Using 8325 shared genes
2025-03-17 16:10:13,390 - INFO - Integrating datasets...
2025-03-17 16:10:13,472 - INFO - Combined dataset shape: (804, 8325)
2025-03-17 16:10:13,473 - INFO - Data is already normalized and log-transformed
2025-03-17 16:10:13,561 - INFO - Applying BBKNN batch correction...
2025-03-17 16:10:17,699 - INFO - Automatically determined k = 6 (sqrt(n) = 27, 10% of smallest class = 6)
2025-03-17 16:10:17,699 - INFO - Performing kNN classification with k=6...
2025-03-17 16:10:17,700 - INFO - Sample values from 'subtypes': ['Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells', 'Interm. Tracheal Cells']
2025-03-17 16:10:17,711 - INFO - Successfully extracted 780 reference labels
2025-03-17 16:10:17,711 - INFO - Reference cells: 780, Bulk samples: 24
2025-03-17 16:10:17,711 - INFO - Using UMAP embeddings for kNN search
2025-03-17 16:10:17,711 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-17 16:10:18,092 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-17 16:10:18,432 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-17 16:10:18,771 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-17 16:10:19,109 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-17 16:10:19,448 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-17 16:10:19,795 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-17 16:10:20,142 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-17 16:10:20,482 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-17 16:10:20,820 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-17 16:10:21,157 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-17 16:10:21,495 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-17 16:10:21,837 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-17 16:10:22,179 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-17 16:10:22,519 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-17 16:10:22,857 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-17 16:10:23,196 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-17 16:10:23,535 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-17 16:10:23,873 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-17 16:10:24,213 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-17 16:10:24,555 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-17 16:10:24,896 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-17 16:10:25,236 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-17 16:10:25,575 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-17 16:10:25,922 - INFO - kNN classification completed for all 24 bulk samples
2025-03-17 16:10:25,922 - INFO - Classification summary:
2025-03-17 16:10:25,924 - INFO -   Interm. Tracheal Cells: 24 bulk samples (mean confidence: 1.0000)
2025-03-17 16:10:25,924 - INFO - P-value summary:
2025-03-17 16:10:25,924 - INFO -   Mean p-value: 1.0000
2025-03-17 16:10:25,925 - INFO -   Median p-value: 1.0000
2025-03-17 16:10:25,925 - INFO -   Min p-value: 1.0000
2025-03-17 16:10:25,925 - INFO -   Max p-value: 1.0000
2025-03-17 16:10:25,925 - INFO - Generating UMAP visualizations...
2025-03-17 16:10:43,681 - INFO - UMAP visualizations completed
2025-03-17 16:10:44,136 - INFO - Integration pipeline completed successfully
2025-03-17 16:10:44,136 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_germline
2025-03-17 16:10:44,136 - INFO - Plotting UMAP...
