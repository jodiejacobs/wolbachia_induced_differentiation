2025-03-13 13:05:24,359 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-13 13:05:24,359 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-13 13:05:24,359 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_normalize.h5ad
2025-03-13 13:05:24,359 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:05:24,359 - INFO - Loading data files...
2025-03-13 13:05:24,903 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-13 13:05:24,905 - ERROR - Error loading reference data: [Errno 2] Unable to synchronously open file (unable to open file: name = '/private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_normalize.h5ad', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
2025-03-13 13:05:48,255 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-13 13:05:48,255 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-13 13:05:48,255 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_normalize.h5ad
2025-03-13 13:05:48,255 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:05:48,255 - INFO - Loading data files...
2025-03-13 13:05:48,425 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-13 13:05:48,426 - ERROR - Error loading reference data: [Errno 2] Unable to synchronously open file (unable to open file: name = '/private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_normalize.h5ad', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
2025-03-13 13:06:09,268 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-13 13:06:09,270 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-13 13:06:09,270 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_normalized.h5ad
2025-03-13 13:06:09,270 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:06:09,270 - INFO - Loading data files...
2025-03-13 13:06:09,447 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-13 13:06:28,435 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-13 13:06:28,446 - INFO - Number of shared genes: 10618
2025-03-13 13:06:28,447 - INFO - Preprocessing datasets...
2025-03-13 13:06:33,211 - INFO - Using 10618 shared genes
2025-03-13 13:06:57,244 - INFO - Integrating datasets...
2025-03-13 13:06:57,620 - INFO - Combined dataset shape: (12822, 10618)
2025-03-13 13:06:57,620 - INFO - Data is already normalized and log-transformed
2025-03-13 13:07:04,820 - INFO - Applying BBKNN batch correction...
2025-03-13 13:07:10,165 - INFO - Automatically determined k = 23 (sqrt(n) = 113, 10% of smallest class = 23)
2025-03-13 13:07:10,165 - INFO - Performing kNN classification with k=23...
2025-03-13 13:07:10,168 - INFO - Sample values from 'cell_type': ['maternal', 'maternal', 'maternal', 'maternal', 'maternal']
2025-03-13 13:07:10,199 - INFO - Successfully extracted 12798 reference labels
2025-03-13 13:07:10,199 - INFO - Reference cells: 12798, Bulk samples: 24
2025-03-13 13:07:10,199 - INFO - Using UMAP embeddings for kNN search
2025-03-13 13:07:10,199 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-13 13:07:10,576 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-13 13:07:10,916 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-13 13:07:11,265 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-13 13:07:11,602 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-13 13:07:11,940 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-13 13:07:12,285 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-13 13:07:12,622 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-13 13:07:12,960 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-13 13:07:13,299 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-13 13:07:13,643 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-13 13:07:13,981 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-13 13:07:14,318 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-13 13:07:14,655 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-13 13:07:15,004 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-13 13:07:15,342 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-13 13:07:15,678 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-13 13:07:16,025 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-13 13:07:16,363 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-13 13:07:16,700 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-13 13:07:17,039 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-13 13:07:17,386 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-13 13:07:17,722 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-13 13:07:18,060 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-13 13:07:18,402 - INFO - kNN classification completed for all 24 bulk samples
2025-03-13 13:07:18,402 - INFO - Classification summary:
2025-03-13 13:07:18,404 - INFO -   maternal: 24 bulk samples (mean confidence: 1.0000)
2025-03-13 13:07:18,404 - INFO - P-value summary:
2025-03-13 13:07:18,404 - INFO -   Mean p-value: 1.0000
2025-03-13 13:07:18,405 - INFO -   Median p-value: 1.0000
2025-03-13 13:07:18,405 - INFO -   Min p-value: 1.0000
2025-03-13 13:07:18,405 - INFO -   Max p-value: 1.0000
2025-03-13 13:07:18,406 - INFO - Generating UMAP visualizations...
2025-03-13 13:09:26,615 - INFO - UMAP visualizations completed
2025-03-13 13:09:27,648 - INFO - Integration pipeline completed successfully
2025-03-13 13:09:27,648 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:09:27,648 - INFO - Plotting UMAP...
2025-03-13 13:17:27,569 - INFO - Starting Scanpy bulk to single-cell integration pipeline
2025-03-13 13:17:27,813 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-13 13:17:27,813 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata.h5ad
2025-03-13 13:17:27,813 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:17:27,813 - INFO - Loading data files...
2025-03-13 13:17:28,016 - INFO - Bulk dataset loaded: (24, 10957) (samples × genes)
2025-03-13 13:17:45,748 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-13 13:17:45,766 - INFO - Number of shared genes: 10618
2025-03-13 13:17:45,766 - INFO - Preprocessing datasets...
2025-03-13 13:17:59,632 - INFO - Using 10618 shared genes
2025-03-13 13:18:23,775 - INFO - Integrating datasets...
2025-03-13 13:18:24,165 - INFO - Combined dataset shape: (12822, 10618)
2025-03-13 13:18:24,165 - INFO - Data is already normalized and log-transformed
2025-03-13 13:18:31,525 - INFO - Applying BBKNN batch correction...
2025-03-13 13:18:36,783 - INFO - Automatically determined k = 23 (sqrt(n) = 113, 10% of smallest class = 23)
2025-03-13 13:18:36,783 - INFO - Performing kNN classification with k=23...
2025-03-13 13:18:36,786 - INFO - Sample values from 'cell_type': ['maternal', 'maternal', 'maternal', 'maternal', 'maternal']
2025-03-13 13:18:36,828 - INFO - Successfully extracted 12798 reference labels
2025-03-13 13:18:36,829 - INFO - Reference cells: 12798, Bulk samples: 24
2025-03-13 13:18:36,829 - INFO - Using UMAP embeddings for kNN search
2025-03-13 13:18:36,829 - INFO - Processing bulk sample 1/24: JW18DOX221117-1
2025-03-13 13:18:37,215 - INFO - Processing bulk sample 2/24: JW18DOX221117-2
2025-03-13 13:18:37,558 - INFO - Processing bulk sample 3/24: JW18DOX221117-3
2025-03-13 13:18:37,904 - INFO - Processing bulk sample 4/24: JW18DOX221117-4
2025-03-13 13:18:38,246 - INFO - Processing bulk sample 5/24: JW18DOX221117-5
2025-03-13 13:18:38,598 - INFO - Processing bulk sample 6/24: JW18DOX221117-6
2025-03-13 13:18:38,967 - INFO - Processing bulk sample 7/24: JW18wMel221117-1
2025-03-13 13:18:39,350 - INFO - Processing bulk sample 8/24: JW18wMel221117-2
2025-03-13 13:18:39,724 - INFO - Processing bulk sample 9/24: JW18wMel221117-3
2025-03-13 13:18:40,094 - INFO - Processing bulk sample 10/24: JW18wMel221117-4
2025-03-13 13:18:40,542 - INFO - Processing bulk sample 11/24: JW18wMel221117-5
2025-03-13 13:18:40,962 - INFO - Processing bulk sample 12/24: JW18wMel221117-6
2025-03-13 13:18:41,372 - INFO - Processing bulk sample 13/24: S2DOX221117-1
2025-03-13 13:18:41,780 - INFO - Processing bulk sample 14/24: S2DOX221117-2
2025-03-13 13:18:42,168 - INFO - Processing bulk sample 15/24: S2DOX221117-3
2025-03-13 13:18:42,552 - INFO - Processing bulk sample 16/24: S2DOX221117-4
2025-03-13 13:18:42,937 - INFO - Processing bulk sample 17/24: S2DOX221117-5
2025-03-13 13:18:43,316 - INFO - Processing bulk sample 18/24: S2DOX221117-6
2025-03-13 13:18:43,702 - INFO - Processing bulk sample 19/24: S2wMel221117-1
2025-03-13 13:18:44,086 - INFO - Processing bulk sample 20/24: S2wMel221117-2
2025-03-13 13:18:44,466 - INFO - Processing bulk sample 21/24: S2wMel221117-3
2025-03-13 13:18:44,843 - INFO - Processing bulk sample 22/24: S2wMel221117-4
2025-03-13 13:18:45,231 - INFO - Processing bulk sample 23/24: S2wMel221117-5
2025-03-13 13:18:45,612 - INFO - Processing bulk sample 24/24: S2wMel221117-6
2025-03-13 13:18:46,001 - INFO - kNN classification completed for all 24 bulk samples
2025-03-13 13:18:46,001 - INFO - Classification summary:
2025-03-13 13:18:46,003 - INFO -   maternal: 24 bulk samples (mean confidence: 1.0000)
2025-03-13 13:18:46,003 - INFO - P-value summary:
2025-03-13 13:18:46,003 - INFO -   Mean p-value: 1.0000
2025-03-13 13:18:46,004 - INFO -   Median p-value: 1.0000
2025-03-13 13:18:46,004 - INFO -   Min p-value: 1.0000
2025-03-13 13:18:46,004 - INFO -   Max p-value: 1.0000
2025-03-13 13:18:46,004 - INFO - Generating UMAP visualizations...
2025-03-13 13:20:45,853 - INFO - UMAP visualizations completed
2025-03-13 13:20:46,943 - INFO - Integration pipeline completed successfully
2025-03-13 13:20:46,943 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/MNN_kNN_tree/embryo_atlas_v2
2025-03-13 13:20:46,943 - INFO - Plotting UMAP...
