2025-03-11 17:08:48,129 - INFO - Starting cell type deconvolution pipeline
2025-03-11 17:08:48,134 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:08:48,137 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_all.h5ad
2025-03-11 17:08:48,139 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-11 17:08:48,141 - INFO - Loading data files...
2025-03-11 17:08:48,357 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-11 17:11:38,853 - INFO - Starting cell type deconvolution pipeline
2025-03-11 17:11:38,853 - INFO - Starting cell type deconvolution pipeline
2025-03-11 17:11:38,910 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:11:38,910 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-11 17:11:38,912 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 17:11:38,912 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-11 17:11:38,914 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-11 17:11:38,914 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-11 17:11:38,916 - INFO - Loading data files...
2025-03-11 17:11:38,916 - INFO - Loading data files...
2025-03-11 17:11:39,076 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-11 17:11:39,076 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-11 17:15:02,075 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 17:15:02,075 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-11 17:15:02,137 - INFO - Using 10618 shared genes
2025-03-11 17:15:02,137 - INFO - Using 10618 shared genes
2025-03-11 17:15:02,139 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-11 17:15:02,139 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-11 17:15:02,141 - INFO - Found 54 cell types
2025-03-11 17:15:02,141 - INFO - Found 54 cell types
2025-03-11 17:15:02,188 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-11 17:15:02,188 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-11 18:42:39,230 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-11 18:42:39,230 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-11 18:43:02,144 - WARNING - Could not create marker heatmap: "Could not find keys '[np.str_('Act57B'), np.str_('Act5C'), np.str_('Atpalpha'), np.str_('Bsg'), np.str_('CG12011'), np.str_('CG14756'), np.str_('CG16791'), np.str_('CG45263'), np.str_('CG9095'), np.str_('CNBP'), np.str_('CadN'), np.str_('Col4a1'), np.str_('CrebA'), np.str_('CycB'), np.str_('Dl'), np.str_('Fas2'), np.str_('Fas3'), np.str_('Fer1HCH'), np.str_('Fer2LCH'), np.str_('Glut4EF'), np.str_('Gmap'), np.str_('Hrb27C'), np.str_('Hsc70-3'), np.str_('Hsc70-4'), np.str_('Hsp83'), np.str_('Imp'), np.str_('Jupiter'), np.str_('LanA'), np.str_('LanB2'), np.str_('Mhc'), np.str_('Myc'), np.str_('NetB'), np.str_('Osi6'), np.str_('Osi7'), np.str_('Pde1c'), np.str_('Pdi'), np.str_('Pdp1'), np.str_('Plod'), np.str_('Ppn'), np.str_('Pxn'), np.str_('Rbfox1'), np.str_('RpL23A'), np.str_('RpL3'), np.str_('RpL6'), np.str_('Ten-a'), np.str_('Tet'), np.str_('Tm1'), np.str_('Vha16-1'), np.str_('alphaTub84B'), np.str_('apolpp'), np.str_('aqz'), np.str_('betaTub56D'), np.str_('bru3'), np.str_('bt'), np.str_('cpo'), np.str_('ct'), np.str_('cv-c'), np.str_('dhd'), np.str_('eEF1alpha1'), np.str_('eEF2'), np.str_('ect'), np.str_('ed'), np.str_('fax'), np.str_('hth'), np.str_('kek5'), np.str_('kis'), np.str_('lncRNA:Hsromega'), np.str_('lncRNA:roX1'), np.str_('lola'), np.str_('mbl'), np.str_('mgl'), np.str_('mt:lrRNA'), np.str_('nmo'), np.str_('nur'), np.str_('otp'), np.str_('pAbp'), np.str_('pip'), np.str_('ps'), np.str_('pum'), np.str_('pyd'), np.str_('rg'), np.str_('sbb'), np.str_('shep'), np.str_('sli'), np.str_('sm'), np.str_('sqd'), np.str_('tral'), np.str_('trol'), np.str_('tyn'), np.str_('up'), np.str_('verm'), np.str_('vkg'), np.str_('wech'), np.str_('wupA')]' in columns of `adata.obs` or in adata.raw.var_names."
2025-03-11 18:43:02,144 - WARNING - Could not create marker heatmap: "Could not find keys '[np.str_('Act57B'), np.str_('Act5C'), np.str_('Atpalpha'), np.str_('Bsg'), np.str_('CG12011'), np.str_('CG14756'), np.str_('CG16791'), np.str_('CG45263'), np.str_('CG9095'), np.str_('CNBP'), np.str_('CadN'), np.str_('Col4a1'), np.str_('CrebA'), np.str_('CycB'), np.str_('Dl'), np.str_('Fas2'), np.str_('Fas3'), np.str_('Fer1HCH'), np.str_('Fer2LCH'), np.str_('Glut4EF'), np.str_('Gmap'), np.str_('Hrb27C'), np.str_('Hsc70-3'), np.str_('Hsc70-4'), np.str_('Hsp83'), np.str_('Imp'), np.str_('Jupiter'), np.str_('LanA'), np.str_('LanB2'), np.str_('Mhc'), np.str_('Myc'), np.str_('NetB'), np.str_('Osi6'), np.str_('Osi7'), np.str_('Pde1c'), np.str_('Pdi'), np.str_('Pdp1'), np.str_('Plod'), np.str_('Ppn'), np.str_('Pxn'), np.str_('Rbfox1'), np.str_('RpL23A'), np.str_('RpL3'), np.str_('RpL6'), np.str_('Ten-a'), np.str_('Tet'), np.str_('Tm1'), np.str_('Vha16-1'), np.str_('alphaTub84B'), np.str_('apolpp'), np.str_('aqz'), np.str_('betaTub56D'), np.str_('bru3'), np.str_('bt'), np.str_('cpo'), np.str_('ct'), np.str_('cv-c'), np.str_('dhd'), np.str_('eEF1alpha1'), np.str_('eEF2'), np.str_('ect'), np.str_('ed'), np.str_('fax'), np.str_('hth'), np.str_('kek5'), np.str_('kis'), np.str_('lncRNA:Hsromega'), np.str_('lncRNA:roX1'), np.str_('lola'), np.str_('mbl'), np.str_('mgl'), np.str_('mt:lrRNA'), np.str_('nmo'), np.str_('nur'), np.str_('otp'), np.str_('pAbp'), np.str_('pip'), np.str_('ps'), np.str_('pum'), np.str_('pyd'), np.str_('rg'), np.str_('sbb'), np.str_('shep'), np.str_('sli'), np.str_('sm'), np.str_('sqd'), np.str_('tral'), np.str_('trol'), np.str_('tyn'), np.str_('up'), np.str_('verm'), np.str_('vkg'), np.str_('wech'), np.str_('wupA')]' in columns of `adata.obs` or in adata.raw.var_names."
2025-03-11 18:43:02,151 - INFO - Creating cell type signature matrix...
2025-03-11 18:43:02,151 - INFO - Creating cell type signature matrix...
2025-03-11 19:02:22,591 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-11 19:02:22,591 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-11 19:02:23,980 - INFO - Validating deconvolution approach...
2025-03-11 19:02:23,980 - INFO - Validating deconvolution approach...
2025-03-11 19:02:23,982 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-11 19:02:23,982 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-11 19:07:36,295 - INFO - Pseudobulk validation samples created
2025-03-11 19:07:36,295 - INFO - Pseudobulk validation samples created
2025-03-11 19:07:36,713 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:36,713 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:36,834 - INFO - Deconvolved 1/20 bulk samples
2025-03-11 19:07:36,834 - INFO - Deconvolved 1/20 bulk samples
2025-03-11 19:07:37,222 - INFO - Deconvolved 10/20 bulk samples
2025-03-11 19:07:37,222 - INFO - Deconvolved 10/20 bulk samples
2025-03-11 19:07:37,698 - INFO - Deconvolved 20/20 bulk samples
2025-03-11 19:07:37,698 - INFO - Deconvolved 20/20 bulk samples
2025-03-11 19:07:37,700 - INFO - Deconvolution completed
2025-03-11 19:07:37,700 - INFO - Deconvolution completed
2025-03-11 19:07:37,718 - INFO - Validation results: Mean correlation = 0.906, Mean RMSE = 0.033
2025-03-11 19:07:37,718 - INFO - Validation results: Mean correlation = 0.906, Mean RMSE = 0.033
2025-03-11 19:07:38,552 - INFO - Calculating confidence intervals using 1 bootstrap iterations...
2025-03-11 19:07:38,552 - INFO - Calculating confidence intervals using 1 bootstrap iterations...
2025-03-11 19:07:38,615 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:38,615 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:38,718 - INFO - Deconvolved 1/24 bulk samples
2025-03-11 19:07:38,718 - INFO - Deconvolved 1/24 bulk samples
2025-03-11 19:07:39,082 - INFO - Deconvolved 10/24 bulk samples
2025-03-11 19:07:39,082 - INFO - Deconvolved 10/24 bulk samples
2025-03-11 19:07:39,526 - INFO - Deconvolved 20/24 bulk samples
2025-03-11 19:07:39,526 - INFO - Deconvolved 20/24 bulk samples
2025-03-11 19:07:39,686 - INFO - Deconvolved 24/24 bulk samples
2025-03-11 19:07:39,686 - INFO - Deconvolved 24/24 bulk samples
2025-03-11 19:07:39,690 - INFO - Deconvolution completed
2025-03-11 19:07:39,690 - INFO - Deconvolution completed
2025-03-11 19:07:39,730 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:39,730 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-11 19:07:39,820 - INFO - Deconvolved 1/24 bulk samples
2025-03-11 19:07:39,820 - INFO - Deconvolved 1/24 bulk samples
2025-03-11 19:07:39,880 - INFO - Deconvolved 10/24 bulk samples
2025-03-11 19:07:39,880 - INFO - Deconvolved 10/24 bulk samples
2025-03-11 19:07:39,945 - INFO - Deconvolved 20/24 bulk samples
2025-03-11 19:07:39,945 - INFO - Deconvolved 20/24 bulk samples
2025-03-11 19:07:39,971 - INFO - Deconvolved 24/24 bulk samples
2025-03-11 19:07:39,971 - INFO - Deconvolved 24/24 bulk samples
2025-03-11 19:07:39,972 - INFO - Deconvolution completed
2025-03-11 19:07:39,972 - INFO - Deconvolution completed
2025-03-11 19:07:39,978 - INFO - Confidence interval calculation completed
2025-03-11 19:07:39,978 - INFO - Confidence interval calculation completed
2025-03-11 19:07:40,012 - INFO - Creating deconvolution visualizations...
2025-03-11 19:07:40,012 - INFO - Creating deconvolution visualizations...
2025-03-11 19:07:42,233 - INFO - Created deconvolution heatmap
2025-03-11 19:07:42,233 - INFO - Created deconvolution heatmap
2025-03-11 19:07:44,271 - INFO - Created stacked bar chart
2025-03-11 19:07:44,271 - INFO - Created stacked bar chart
2025-03-11 19:07:44,658 - INFO - Created example validation plot
2025-03-11 19:07:44,658 - INFO - Created example validation plot
2025-03-11 19:08:09,955 - INFO - Created sample composition plots
2025-03-11 19:08:09,955 - INFO - Created sample composition plots
2025-03-11 19:08:12,004 - INFO - Created hierarchical clustering plot
2025-03-11 19:08:12,004 - INFO - Created hierarchical clustering plot
2025-03-11 19:08:12,006 - INFO - Visualization creation completed
2025-03-11 19:08:12,006 - INFO - Visualization creation completed
2025-03-11 19:08:12,580 - INFO - Deconvolution pipeline completed successfully
2025-03-11 19:08:12,580 - INFO - Deconvolution pipeline completed successfully
2025-03-11 19:08:12,581 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-11 19:08:12,581 - INFO - Results saved to /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 13:00:48,079 - INFO - Starting cell type deconvolution pipeline
2025-03-12 13:00:48,100 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 13:00:48,102 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 13:00:48,102 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 13:00:48,103 - INFO - Loading data files...
2025-03-12 13:00:48,353 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 13:04:33,335 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 13:04:33,552 - INFO - Using 10618 shared genes
2025-03-12 13:28:45,780 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 13:28:46,097 - INFO - Found 54 cell types
2025-03-12 13:28:46,115 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 13:30:07,981 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 13:31:22,170 - INFO - Created marker gene heatmap
2025-03-12 13:31:22,209 - INFO - Creating cell type signature matrix...
2025-03-12 15:14:30,393 - INFO - Starting cell type deconvolution pipeline
2025-03-12 15:14:30,393 - INFO - Starting cell type deconvolution pipeline
2025-03-12 15:14:30,394 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 15:14:30,394 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 15:14:30,395 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 15:14:30,395 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 15:14:30,397 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 15:14:30,397 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 15:14:30,400 - INFO - Loading data files...
2025-03-12 15:14:30,400 - INFO - Loading data files...
2025-03-12 15:14:30,680 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 15:14:30,680 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 15:20:19,962 - INFO - Starting cell type deconvolution pipeline
2025-03-12 15:20:19,962 - INFO - Starting cell type deconvolution pipeline
2025-03-12 15:20:19,963 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 15:20:19,963 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 15:20:19,965 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 15:20:19,965 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 15:20:19,966 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 15:20:19,966 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 15:20:19,968 - INFO - Loading data files...
2025-03-12 15:20:19,968 - INFO - Loading data files...
2025-03-12 15:20:20,636 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 15:20:20,636 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 15:22:42,753 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 15:22:42,753 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 15:22:43,185 - INFO - Using 10618 shared genes
2025-03-12 15:22:43,185 - INFO - Using 10618 shared genes
2025-03-12 15:47:21,170 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 15:47:21,170 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 15:47:21,208 - INFO - Found 54 cell types
2025-03-12 15:47:21,208 - INFO - Found 54 cell types
2025-03-12 15:47:21,227 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 15:47:21,227 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 15:48:44,602 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 15:48:44,602 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 15:49:59,417 - INFO - Created marker gene heatmap
2025-03-12 15:49:59,417 - INFO - Created marker gene heatmap
2025-03-12 15:49:59,453 - INFO - Creating cell type signature matrix...
2025-03-12 15:49:59,453 - INFO - Creating cell type signature matrix...
2025-03-12 15:55:25,337 - INFO - Creating cell type signature matrix...
2025-03-12 15:55:25,337 - INFO - Creating cell type signature matrix...
2025-03-12 15:57:38,856 - INFO - Creating cell type signature matrix...
2025-03-12 15:57:38,856 - INFO - Creating cell type signature matrix...
2025-03-12 15:57:41,961 - INFO - Creating cell type signature matrix...
2025-03-12 15:57:41,961 - INFO - Creating cell type signature matrix...
2025-03-12 15:59:56,045 - INFO - Creating cell type signature matrix...
2025-03-12 15:59:56,045 - INFO - Creating cell type signature matrix...
2025-03-12 15:59:56,056 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 15:59:56,056 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:00:23,789 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-12 16:00:23,789 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-12 16:00:24,829 - INFO - Validating deconvolution approach...
2025-03-12 16:00:24,829 - INFO - Validating deconvolution approach...
2025-03-12 16:00:24,831 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:00:24,831 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:00:27,321 - INFO - Pseudobulk validation samples created
2025-03-12 16:00:27,321 - INFO - Pseudobulk validation samples created
2025-03-12 16:00:27,322 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:00:27,322 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:35:06,658 - INFO - Creating cell type signature matrix...
2025-03-12 16:35:06,658 - INFO - Creating cell type signature matrix...
2025-03-12 16:35:06,671 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:35:06,671 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:35:34,487 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-12 16:35:34,487 - INFO - Created signature matrix with 10618 genes and 54 cell types
2025-03-12 16:35:35,553 - INFO - Validating deconvolution approach...
2025-03-12 16:35:35,553 - INFO - Validating deconvolution approach...
2025-03-12 16:35:35,563 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:35:35,563 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:35:37,638 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:35:37,638 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:35:39,853 - INFO - Pseudobulk validation samples created
2025-03-12 16:35:39,853 - INFO - Pseudobulk validation samples created
2025-03-12 16:35:39,854 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:35:39,854 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:09,947 - INFO - Validating deconvolution approach...
2025-03-12 16:37:09,947 - INFO - Validating deconvolution approach...
2025-03-12 16:37:10,543 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:37:10,543 - INFO - Found 8134 valid genes out of 10618 shared genes
2025-03-12 16:37:12,604 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:37:12,604 - INFO - Creating 20 pseudobulk samples for validation...
2025-03-12 16:37:14,693 - INFO - Pseudobulk validation samples created
2025-03-12 16:37:14,693 - INFO - Pseudobulk validation samples created
2025-03-12 16:37:14,695 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:14,695 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:14,714 - ERROR - Error deconvolving sample pseudobulk_0: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,714 - ERROR - Error deconvolving sample pseudobulk_0: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,716 - ERROR - Error deconvolving sample pseudobulk_1: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,716 - ERROR - Error deconvolving sample pseudobulk_1: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,718 - ERROR - Error deconvolving sample pseudobulk_2: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,718 - ERROR - Error deconvolving sample pseudobulk_2: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,720 - ERROR - Error deconvolving sample pseudobulk_3: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,720 - ERROR - Error deconvolving sample pseudobulk_3: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,721 - ERROR - Error deconvolving sample pseudobulk_4: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,721 - ERROR - Error deconvolving sample pseudobulk_4: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,723 - ERROR - Error deconvolving sample pseudobulk_5: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,723 - ERROR - Error deconvolving sample pseudobulk_5: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,725 - ERROR - Error deconvolving sample pseudobulk_6: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,725 - ERROR - Error deconvolving sample pseudobulk_6: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,727 - ERROR - Error deconvolving sample pseudobulk_7: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,727 - ERROR - Error deconvolving sample pseudobulk_7: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,728 - ERROR - Error deconvolving sample pseudobulk_8: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,728 - ERROR - Error deconvolving sample pseudobulk_8: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,732 - ERROR - Error deconvolving sample pseudobulk_9: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,732 - ERROR - Error deconvolving sample pseudobulk_9: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,734 - ERROR - Error deconvolving sample pseudobulk_10: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,734 - ERROR - Error deconvolving sample pseudobulk_10: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,736 - ERROR - Error deconvolving sample pseudobulk_11: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,736 - ERROR - Error deconvolving sample pseudobulk_11: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,737 - ERROR - Error deconvolving sample pseudobulk_12: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,737 - ERROR - Error deconvolving sample pseudobulk_12: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,739 - ERROR - Error deconvolving sample pseudobulk_13: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,739 - ERROR - Error deconvolving sample pseudobulk_13: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,741 - ERROR - Error deconvolving sample pseudobulk_14: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,741 - ERROR - Error deconvolving sample pseudobulk_14: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,742 - ERROR - Error deconvolving sample pseudobulk_15: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,742 - ERROR - Error deconvolving sample pseudobulk_15: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,744 - ERROR - Error deconvolving sample pseudobulk_16: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,744 - ERROR - Error deconvolving sample pseudobulk_16: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,746 - ERROR - Error deconvolving sample pseudobulk_17: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,746 - ERROR - Error deconvolving sample pseudobulk_17: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,748 - ERROR - Error deconvolving sample pseudobulk_18: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,748 - ERROR - Error deconvolving sample pseudobulk_18: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,749 - ERROR - Error deconvolving sample pseudobulk_19: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,749 - ERROR - Error deconvolving sample pseudobulk_19: Incompatible dimensions. The first dimension of A is 10618, while the shape of b is (8134,)
2025-03-12 16:37:14,750 - INFO - Deconvolution completed
2025-03-12 16:37:14,750 - INFO - Deconvolution completed
2025-03-12 16:37:14,752 - WARNING - NaN values found for sample pseudobulk_0, skipping
2025-03-12 16:37:14,752 - WARNING - NaN values found for sample pseudobulk_0, skipping
2025-03-12 16:37:14,753 - WARNING - NaN values found for sample pseudobulk_1, skipping
2025-03-12 16:37:14,753 - WARNING - NaN values found for sample pseudobulk_1, skipping
2025-03-12 16:37:14,754 - WARNING - NaN values found for sample pseudobulk_2, skipping
2025-03-12 16:37:14,754 - WARNING - NaN values found for sample pseudobulk_2, skipping
2025-03-12 16:37:14,756 - WARNING - NaN values found for sample pseudobulk_3, skipping
2025-03-12 16:37:14,756 - WARNING - NaN values found for sample pseudobulk_3, skipping
2025-03-12 16:37:14,758 - WARNING - NaN values found for sample pseudobulk_4, skipping
2025-03-12 16:37:14,758 - WARNING - NaN values found for sample pseudobulk_4, skipping
2025-03-12 16:37:14,760 - WARNING - NaN values found for sample pseudobulk_5, skipping
2025-03-12 16:37:14,760 - WARNING - NaN values found for sample pseudobulk_5, skipping
2025-03-12 16:37:14,761 - WARNING - NaN values found for sample pseudobulk_6, skipping
2025-03-12 16:37:14,761 - WARNING - NaN values found for sample pseudobulk_6, skipping
2025-03-12 16:37:14,762 - WARNING - NaN values found for sample pseudobulk_7, skipping
2025-03-12 16:37:14,762 - WARNING - NaN values found for sample pseudobulk_7, skipping
2025-03-12 16:37:14,765 - WARNING - NaN values found for sample pseudobulk_8, skipping
2025-03-12 16:37:14,765 - WARNING - NaN values found for sample pseudobulk_8, skipping
2025-03-12 16:37:14,767 - WARNING - NaN values found for sample pseudobulk_9, skipping
2025-03-12 16:37:14,767 - WARNING - NaN values found for sample pseudobulk_9, skipping
2025-03-12 16:37:14,768 - WARNING - NaN values found for sample pseudobulk_10, skipping
2025-03-12 16:37:14,768 - WARNING - NaN values found for sample pseudobulk_10, skipping
2025-03-12 16:37:14,769 - WARNING - NaN values found for sample pseudobulk_11, skipping
2025-03-12 16:37:14,769 - WARNING - NaN values found for sample pseudobulk_11, skipping
2025-03-12 16:37:14,771 - WARNING - NaN values found for sample pseudobulk_12, skipping
2025-03-12 16:37:14,771 - WARNING - NaN values found for sample pseudobulk_12, skipping
2025-03-12 16:37:14,773 - WARNING - NaN values found for sample pseudobulk_13, skipping
2025-03-12 16:37:14,773 - WARNING - NaN values found for sample pseudobulk_13, skipping
2025-03-12 16:37:14,774 - WARNING - NaN values found for sample pseudobulk_14, skipping
2025-03-12 16:37:14,774 - WARNING - NaN values found for sample pseudobulk_14, skipping
2025-03-12 16:37:14,776 - WARNING - NaN values found for sample pseudobulk_15, skipping
2025-03-12 16:37:14,776 - WARNING - NaN values found for sample pseudobulk_15, skipping
2025-03-12 16:37:14,777 - WARNING - NaN values found for sample pseudobulk_16, skipping
2025-03-12 16:37:14,777 - WARNING - NaN values found for sample pseudobulk_16, skipping
2025-03-12 16:37:14,778 - WARNING - NaN values found for sample pseudobulk_17, skipping
2025-03-12 16:37:14,778 - WARNING - NaN values found for sample pseudobulk_17, skipping
2025-03-12 16:37:14,780 - WARNING - NaN values found for sample pseudobulk_18, skipping
2025-03-12 16:37:14,780 - WARNING - NaN values found for sample pseudobulk_18, skipping
2025-03-12 16:37:14,781 - WARNING - NaN values found for sample pseudobulk_19, skipping
2025-03-12 16:37:14,781 - WARNING - NaN values found for sample pseudobulk_19, skipping
2025-03-12 16:37:14,783 - WARNING - No valid correlations calculated
2025-03-12 16:37:14,783 - WARNING - No valid correlations calculated
2025-03-12 16:37:14,784 - WARNING - No valid RMSE values calculated
2025-03-12 16:37:14,784 - WARNING - No valid RMSE values calculated
2025-03-12 16:37:14,785 - INFO - Validation results: Mean correlation = 0.000, Mean RMSE = 0.000
2025-03-12 16:37:14,785 - INFO - Validation results: Mean correlation = 0.000, Mean RMSE = 0.000
2025-03-12 16:37:14,827 - WARNING - Not enough valid data points to create validation plot
2025-03-12 16:37:14,827 - WARNING - Not enough valid data points to create validation plot
2025-03-12 16:37:14,828 - INFO - Calculating confidence intervals using 1 bootstrap iterations...
2025-03-12 16:37:14,828 - INFO - Calculating confidence intervals using 1 bootstrap iterations...
2025-03-12 16:37:14,880 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:14,880 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:14,978 - INFO - Deconvolved 1/24 bulk samples
2025-03-12 16:37:14,978 - INFO - Deconvolved 1/24 bulk samples
2025-03-12 16:37:15,410 - INFO - Deconvolved 10/24 bulk samples
2025-03-12 16:37:15,410 - INFO - Deconvolved 10/24 bulk samples
2025-03-12 16:37:15,854 - INFO - Deconvolved 20/24 bulk samples
2025-03-12 16:37:15,854 - INFO - Deconvolved 20/24 bulk samples
2025-03-12 16:37:16,066 - INFO - Deconvolved 24/24 bulk samples
2025-03-12 16:37:16,066 - INFO - Deconvolved 24/24 bulk samples
2025-03-12 16:37:16,071 - INFO - Deconvolution completed
2025-03-12 16:37:16,071 - INFO - Deconvolution completed
2025-03-12 16:37:16,118 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:16,118 - INFO - Deconvolving bulk samples into cell type proportions...
2025-03-12 16:37:16,209 - INFO - Deconvolved 1/24 bulk samples
2025-03-12 16:37:16,209 - INFO - Deconvolved 1/24 bulk samples
2025-03-12 16:37:16,266 - INFO - Deconvolved 10/24 bulk samples
2025-03-12 16:37:16,266 - INFO - Deconvolved 10/24 bulk samples
2025-03-12 16:37:16,325 - INFO - Deconvolved 20/24 bulk samples
2025-03-12 16:37:16,325 - INFO - Deconvolved 20/24 bulk samples
2025-03-12 16:37:16,349 - INFO - Deconvolved 24/24 bulk samples
2025-03-12 16:37:16,349 - INFO - Deconvolved 24/24 bulk samples
2025-03-12 16:37:16,350 - INFO - Deconvolution completed
2025-03-12 16:37:16,350 - INFO - Deconvolution completed
2025-03-12 16:37:16,356 - INFO - Confidence interval calculation completed
2025-03-12 16:37:16,356 - INFO - Confidence interval calculation completed
2025-03-12 16:43:40,256 - INFO - Starting cell type deconvolution pipeline
2025-03-12 16:43:40,256 - INFO - Starting cell type deconvolution pipeline
2025-03-12 16:43:40,256 - INFO - Starting cell type deconvolution pipeline
2025-03-12 16:43:40,258 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 16:43:40,258 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 16:43:40,258 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 16:43:40,259 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 16:43:40,259 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 16:43:40,259 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/embryo_adata_dense.h5ad
2025-03-12 16:43:40,261 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 16:43:40,261 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 16:43:40,261 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/embryo_atlas
2025-03-12 16:43:40,262 - INFO - Loading data files...
2025-03-12 16:43:40,262 - INFO - Loading data files...
2025-03-12 16:43:40,262 - INFO - Loading data files...
2025-03-12 16:43:41,014 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 16:43:41,014 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 16:43:41,014 - INFO - Bulk dataset loaded: (24, 10957) (cells × genes)
2025-03-12 16:47:10,645 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 16:47:10,645 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 16:47:10,645 - INFO - Reference dataset loaded: (502680, 23932) (cells × genes)
2025-03-12 16:47:19,351 - INFO - Using 10618 shared genes
2025-03-12 16:47:19,351 - INFO - Using 10618 shared genes
2025-03-12 16:47:19,351 - INFO - Using 10618 shared genes
2025-03-12 17:03:20,336 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 17:03:20,336 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 17:03:20,336 - INFO - Identifying marker genes for each cell type using cell_type...
2025-03-12 17:03:20,462 - INFO - Found 54 cell types
2025-03-12 17:03:20,462 - INFO - Found 54 cell types
2025-03-12 17:03:20,462 - INFO - Found 54 cell types
2025-03-12 17:03:20,479 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 17:03:20,479 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 17:03:20,479 - INFO - Using 54 cell types with more than one sample for statistical testing
2025-03-12 17:05:03,343 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 17:05:03,343 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 17:05:03,343 - INFO - Identified 100 marker genes for each of 54 cell types
2025-03-12 17:06:10,229 - INFO - Created marker gene heatmap
2025-03-12 17:06:10,229 - INFO - Created marker gene heatmap
2025-03-12 17:06:10,229 - INFO - Created marker gene heatmap
2025-03-12 17:06:10,557 - INFO - Creating cell type signature matrix...
2025-03-12 17:06:10,557 - INFO - Creating cell type signature matrix...
2025-03-12 17:06:10,557 - INFO - Creating cell type signature matrix...
