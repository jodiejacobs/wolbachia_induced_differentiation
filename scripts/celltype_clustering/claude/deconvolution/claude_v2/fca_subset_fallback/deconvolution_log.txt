2025-03-12 17:33:41,621 - INFO - Starting enhanced cell type deconvolution pipeline
2025-03-12 17:33:41,621 - INFO - Bulk data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/scanpy_objects/bulk_adata.h5ad
2025-03-12 17:33:41,622 - INFO - Reference data: /private/groups/russelllab/jodie/wolbachia_induced_DE/scanpy_clustering/data/atlas/fca_subset.h5ad
2025-03-12 17:33:41,622 - INFO - Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/claude_v2/fca_subset_fallback
2025-03-12 17:33:41,622 - INFO - Normalization method: quantile
2025-03-12 17:35:37,486 - INFO - Using 1234 shared genes
2025-03-12 17:38:59,861 - INFO - Applied quantile normalization
2025-03-12 17:39:34,120 - ERROR - Deconvolution pipeline failed: Could not calculate statistics for groups adult hindgut, germline cell, unknown stage, Poxn neuron, antennal lobe projection neuron, midgut, ocellus retinula cell, anterior ejaculatory duct, adult peripheral neuron of the heart, sensory neuron, bitter-sensitive labellar taste bristle, transmedullary neuron Tm5c, late primary spermatocyte, male reproductive tract muscle, spermatocyte 4, photoreceptor-like, adult olfactory receptor neuron Or13a, spermatocyte 5, posterior midgut*, dopaminergic PAM neuron, spermatocyte cyst cell branch b, post-mitotic germ cell early 16-cell cyst, adult olfactory receptor neuron Or85a, Or43b, visceral muscle of the midgut, enteroendocrine cell, dorsal appendage forming follicle cell, distal medullary amacrine neuron Dm12, crystal cell, Kenyon cell, lobula columnar neuron LC10, early cyst cell 2, transmedullary neuron Tm29, male accessory gland secondary cell, distal medullary amacrine neuron Dm10, polar follicle cell, adult pylorus, distal medullary amacrine neuron Dm9, lobula columnar neuron LC12, adult olfactory receptor neuron Ir84a, Ir31a, Ir76a, Ir76b, Ir8a, Or35a, adult brain cell body glial cell, adult olfactory receptor neuron unknown type, Orco- since they only contain one sample.
2025-03-12 17:39:34,128 - ERROR - Traceback (most recent call last):
  File "/private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/claude_v2/main_deconvolution.py", line 169, in main
    markers_dict = identify_cell_type_markers(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/private/groups/russelllab/jodie/wolbachia_induced_DE/wolbachia_induced_differentiation/scripts/celltype_clustering/claude/deconvolution/claude_v2/cell_type_deconvolution.py", line 406, in identify_cell_type_markers
    sc.tl.rank_genes_groups(adata, groupby, method='wilcoxon')
  File "/private/home/jomojaco/mambaforge/envs/scanpy/lib/python3.12/site-packages/legacy_api_wrap/__init__.py", line 80, in fn_compatible
    return fn(*args_all, **kw)
           ^^^^^^^^^^^^^^^^^^^
  File "/private/home/jomojaco/mambaforge/envs/scanpy/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py", line 650, in rank_genes_groups
    test_obj = _RankGenes(
               ^^^^^^^^^^^
  File "/private/home/jomojaco/mambaforge/envs/scanpy/lib/python3.12/site-packages/scanpy/tools/_rank_genes_groups.py", line 121, in __init__
    raise ValueError(
ValueError: Could not calculate statistics for groups adult hindgut, germline cell, unknown stage, Poxn neuron, antennal lobe projection neuron, midgut, ocellus retinula cell, anterior ejaculatory duct, adult peripheral neuron of the heart, sensory neuron, bitter-sensitive labellar taste bristle, transmedullary neuron Tm5c, late primary spermatocyte, male reproductive tract muscle, spermatocyte 4, photoreceptor-like, adult olfactory receptor neuron Or13a, spermatocyte 5, posterior midgut*, dopaminergic PAM neuron, spermatocyte cyst cell branch b, post-mitotic germ cell early 16-cell cyst, adult olfactory receptor neuron Or85a, Or43b, visceral muscle of the midgut, enteroendocrine cell, dorsal appendage forming follicle cell, distal medullary amacrine neuron Dm12, crystal cell, Kenyon cell, lobula columnar neuron LC10, early cyst cell 2, transmedullary neuron Tm29, male accessory gland secondary cell, distal medullary amacrine neuron Dm10, polar follicle cell, adult pylorus, distal medullary amacrine neuron Dm9, lobula columnar neuron LC12, adult olfactory receptor neuron Ir84a, Ir31a, Ir76a, Ir76b, Ir8a, Or35a, adult brain cell body glial cell, adult olfactory receptor neuron unknown type, Orco- since they only contain one sample.

